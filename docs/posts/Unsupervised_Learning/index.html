<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Juan Isaula">
<meta name="dcterms.date" content="2025-09-07">

<title>Aprendizaje No Supervisado – Juan Isaula</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-b4960eac7a6f9fac35b610a7dc5af25a.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="../../styles.css">
<meta property="og:title" content="Aprendizaje No Supervisado – Juan Isaula">
<meta property="og:description" content="Python">
<meta property="og:image" content="https://j-isaula.github.io/Web_JI/posts/Unsupervised_Learning/fondo.png">
<meta property="og:site_name" content="Juan Isaula">
<meta property="og:locale" content="en_US">
<meta property="og:image:height" content="576">
<meta property="og:image:width" content="1024">
<meta name="twitter:title" content="Aprendizaje No Supervisado – Juan Isaula">
<meta name="twitter:description" content="Python">
<meta name="twitter:image" content="https://j-isaula.github.io/Web_JI/posts/Unsupervised_Learning/fondo.png">
<meta name="twitter:creator" content="@isaula_im">
<meta name="twitter:image-height" content="576">
<meta name="twitter:image-width" content="1024">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Juan Isaula</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../papers"> 
<span class="menu-text">Articles</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../cursos_impartidos"> 
<span class="menu-text">UNAH Courses</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../blog.html"> 
<span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../Dasboard"> 
<span class="menu-text">Dashboards</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../Sobre_mi"> 
<span class="menu-text">Historias</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#agrupación-para-la-exploración-de-conjuntos-de-datos" id="toc-agrupación-para-la-exploración-de-conjuntos-de-datos" class="nav-link active" data-scroll-target="#agrupación-para-la-exploración-de-conjuntos-de-datos">Agrupación para la exploración de conjuntos de datos</a>
  <ul class="collapse">
  <li><a href="#aprendizaje-no-supervizado" id="toc-aprendizaje-no-supervizado" class="nav-link" data-scroll-target="#aprendizaje-no-supervizado">Aprendizaje no supervizado</a>
  <ul class="collapse">
  <li><a href="#iris-dataset" id="toc-iris-dataset" class="nav-link" data-scroll-target="#iris-dataset">Iris dataset</a></li>
  <li><a href="#k-means-clustering" id="toc-k-means-clustering" class="nav-link" data-scroll-target="#k-means-clustering">K-Means Clustering</a></li>
  </ul></li>
  <li><a href="#evaluar-una-agrupación" id="toc-evaluar-una-agrupación" class="nav-link" data-scroll-target="#evaluar-una-agrupación">Evaluar una agrupación</a>
  <ul class="collapse">
  <li><a href="#iris-clusters-vs-especies" id="toc-iris-clusters-vs-especies" class="nav-link" data-scroll-target="#iris-clusters-vs-especies">Iris: Clusters vs Especies</a></li>
  <li><a href="#cross-tabulation-con-pandas" id="toc-cross-tabulation-con-pandas" class="nav-link" data-scroll-target="#cross-tabulation-con-pandas">Cross Tabulation con Pandas</a></li>
  <li><a href="#medición-de-la-calidad-de-la-agrupación" id="toc-medición-de-la-calidad-de-la-agrupación" class="nav-link" data-scroll-target="#medición-de-la-calidad-de-la-agrupación">Medición de la calidad de la agrupación</a></li>
  </ul></li>
  <li><a href="#transformación-de-características-para-mejorar-agrupaciones" id="toc-transformación-de-características-para-mejorar-agrupaciones" class="nav-link" data-scroll-target="#transformación-de-características-para-mejorar-agrupaciones">Transformación de Características para mejorar agrupaciones</a>
  <ul class="collapse">
  <li><a href="#clustering-con-vinos" id="toc-clustering-con-vinos" class="nav-link" data-scroll-target="#clustering-con-vinos">Clustering con Vinos</a></li>
  <li><a href="#standarscaler" id="toc-standarscaler" class="nav-link" data-scroll-target="#standarscaler">StandarScaler</a></li>
  <li><a href="#standardscaler-luego-kmeans" id="toc-standardscaler-luego-kmeans" class="nav-link" data-scroll-target="#standardscaler-luego-kmeans">StandardScaler luego KMeans</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#visualización-con-agrupamiento-jerárquico-y-t-sne" id="toc-visualización-con-agrupamiento-jerárquico-y-t-sne" class="nav-link" data-scroll-target="#visualización-con-agrupamiento-jerárquico-y-t-sne"><strong>Visualización con agrupamiento Jerárquico y t-SNE</strong></a>
  <ul class="collapse">
  <li><a href="#visualizar-jerarquías" id="toc-visualizar-jerarquías" class="nav-link" data-scroll-target="#visualizar-jerarquías">Visualizar Jerarquías</a>
  <ul class="collapse">
  <li><a href="#dataset-de-scoring-eurovision" id="toc-dataset-de-scoring-eurovision" class="nav-link" data-scroll-target="#dataset-de-scoring-eurovision">Dataset de scoring Eurovision</a></li>
  <li><a href="#dendrograma-de-una-clusterización-jerárquica" id="toc-dendrograma-de-una-clusterización-jerárquica" class="nav-link" data-scroll-target="#dendrograma-de-una-clusterización-jerárquica">Dendrograma de una Clusterización Jerárquica</a></li>
  <li><a href="#clusterización-jerárquica-con-scipy" id="toc-clusterización-jerárquica-con-scipy" class="nav-link" data-scroll-target="#clusterización-jerárquica-con-scipy">Clusterización Jerárquica con SciPy</a></li>
  </ul></li>
  <li><a href="#etiquetas-de-clústeres-en-la-agrupación-jerárquica" id="toc-etiquetas-de-clústeres-en-la-agrupación-jerárquica" class="nav-link" data-scroll-target="#etiquetas-de-clústeres-en-la-agrupación-jerárquica">Etiquetas de clústeres en la agrupación jerárquica</a>
  <ul class="collapse">
  <li><a href="#agrupaciones-intermedias-y-altura-en-el-dendrograma" id="toc-agrupaciones-intermedias-y-altura-en-el-dendrograma" class="nav-link" data-scroll-target="#agrupaciones-intermedias-y-altura-en-el-dendrograma">Agrupaciones intermedias y altura en el dendrograma</a></li>
  <li><a href="#distancia-entre-clusters" id="toc-distancia-entre-clusters" class="nav-link" data-scroll-target="#distancia-entre-clusters">Distancia entre Clusters</a></li>
  <li><a href="#extracción-de-etiquetas-de-clúster-mediante-fcluster." id="toc-extracción-de-etiquetas-de-clúster-mediante-fcluster." class="nav-link" data-scroll-target="#extracción-de-etiquetas-de-clúster-mediante-fcluster.">Extracción de etiquetas de clúster mediante <code>fcluster.</code></a></li>
  <li><a href="#alineación-de-las-etiquetes-de-los-clústeres-con-los-nombres-de-las-empresas" id="toc-alineación-de-las-etiquetes-de-los-clústeres-con-los-nombres-de-las-empresas" class="nav-link" data-scroll-target="#alineación-de-las-etiquetes-de-los-clústeres-con-los-nombres-de-las-empresas">Alineación de las etiquetes de los clústeres con los nombres de las empresas</a></li>
  <li><a href="#t-sne-para-mapas-bidimensionales" id="toc-t-sne-para-mapas-bidimensionales" class="nav-link" data-scroll-target="#t-sne-para-mapas-bidimensionales">t-SNE para mapas bidimensionales</a></li>
  <li><a href="#mapa-t-sne-del-mercado-bursátil" id="toc-mapa-t-sne-del-mercado-bursátil" class="nav-link" data-scroll-target="#mapa-t-sne-del-mercado-bursátil">Mapa t-SNE del mercado bursátil</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#descorrelación-de-datos-y-reducción-de-dimensiones" id="toc-descorrelación-de-datos-y-reducción-de-dimensiones" class="nav-link" data-scroll-target="#descorrelación-de-datos-y-reducción-de-dimensiones">Descorrelación de Datos y Reducción de Dimensiones</a>
  <ul class="collapse">
  <li><a href="#visualización-de-la-transformación-pca" id="toc-visualización-de-la-transformación-pca" class="nav-link" data-scroll-target="#visualización-de-la-transformación-pca">Visualización de la transformación PCA</a>
  <ul class="collapse">
  <li><a href="#análisis-de-componentes-principales" id="toc-análisis-de-componentes-principales" class="nav-link" data-scroll-target="#análisis-de-componentes-principales">Análisis de componentes principales</a></li>
  <li><a href="#pca-en-scikit---learn" id="toc-pca-en-scikit---learn" class="nav-link" data-scroll-target="#pca-en-scikit---learn">PCA en Scikit - Learn</a></li>
  <li><a href="#las-características-de-pca-no-están-correlacionadas" id="toc-las-características-de-pca-no-están-correlacionadas" class="nav-link" data-scroll-target="#las-características-de-pca-no-están-correlacionadas">LAs características de PCA no están correlacionadas</a></li>
  <li><a href="#componentes-principales" id="toc-componentes-principales" class="nav-link" data-scroll-target="#componentes-principales">Componentes Principales</a></li>
  </ul></li>
  <li><a href="#dimensión-intrínseca" id="toc-dimensión-intrínseca" class="nav-link" data-scroll-target="#dimensión-intrínseca">Dimensión Intrínseca</a>
  <ul class="collapse">
  <li><a href="#dimensión-intrínsica" id="toc-dimensión-intrínsica" class="nav-link" data-scroll-target="#dimensión-intrínsica">Dimensión Intrínsica</a></li>
  <li><a href="#pca-identifica-la-dimensión-intrínseca" id="toc-pca-identifica-la-dimensión-intrínseca" class="nav-link" data-scroll-target="#pca-identifica-la-dimensión-intrínseca">PCA identifica la dimensión intrínseca</a></li>
  <li><a href="#las-carasterísticas-de-pca-se-ordenan-por-varianza-descendente" id="toc-las-carasterísticas-de-pca-se-ordenan-por-varianza-descendente" class="nav-link" data-scroll-target="#las-carasterísticas-de-pca-se-ordenan-por-varianza-descendente">Las carasterísticas de PCA se ordenan por varianza descendente</a></li>
  <li><a href="#varianza-y-dimensión-intrínseca" id="toc-varianza-y-dimensión-intrínseca" class="nav-link" data-scroll-target="#varianza-y-dimensión-intrínseca">Varianza y Dimensión Intrínseca</a></li>
  <li><a href="#plotting-de-varianza-de-pca" id="toc-plotting-de-varianza-de-pca" class="nav-link" data-scroll-target="#plotting-de-varianza-de-pca">Plotting de varianza de PCA</a></li>
  </ul></li>
  <li><a href="#reducción-de-dimensiones-con-pca" id="toc-reducción-de-dimensiones-con-pca" class="nav-link" data-scroll-target="#reducción-de-dimensiones-con-pca">Reducción de dimensiones con PCA</a>
  <ul class="collapse">
  <li><a href="#matrices-de-frecuencia-de-palabras" id="toc-matrices-de-frecuencia-de-palabras" class="nav-link" data-scroll-target="#matrices-de-frecuencia-de-palabras">Matrices de frecuencia de palabras</a></li>
  <li><a href="#truncatedsvd-csr_matrix" id="toc-truncatedsvd-csr_matrix" class="nav-link" data-scroll-target="#truncatedsvd-csr_matrix">TruncatedSVD &amp; csr_matrix</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Aprendizaje No Supervisado</h1>
<p class="subtitle lead">Python</p>
  <div class="quarto-categories">
    <div class="quarto-category">Python</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Juan Isaula </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">September 7, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p>Supongamos que tiene una colección de clientes con diversas características, como <em>edad, ubicación e historial financiero</em>, y deseas descubrir patrones y clasificarlos en grupos. O quizás tengas un conjunto de textos, como páginas de Wikipedia, y quieras segmentarlos en categorías en función de su contenido. Este es el mundo del aprendizaje no supervizado, llamado así porque no estás guiando, o supervisando, el descubrimiento de patrones mediante alguna tarea de predicción, sino descubriendo la estructura oculta a partir de datos no etiquetados. El aprendizaje no supervizado engloba diversas técnicas de aprendizaje automático, desde la agrupación hasta la reducción de dimensiones y la factorización de matrices. En este artículo, aprenderás los fundamentos de <strong>aprendizaje no supervizado</strong> e implementarás los algoritmos esenciales utilizando <code>scikit-learn</code> y <code>SciPy</code>. Aprenderás a agrupar, transformar, visualizar y extraer información de conjuntos de datos no etiquetados.</p>
<section id="agrupación-para-la-exploración-de-conjuntos-de-datos" class="level1">
<h1>Agrupación para la exploración de conjuntos de datos</h1>
<p>El objetivo de esta sección es aprender a descubrir los grupos subyacentes (o clústeres) en un conjunto de datos. En esta sección aprendera a agrupar empresas utilizando sus cotizaciones bursátiles,y distinguir diferentes especies agrupando sus medidas.</p>
<section id="aprendizaje-no-supervizado" class="level2">
<h2 class="anchored" data-anchor-id="aprendizaje-no-supervizado">Aprendizaje no supervizado</h2>
<p>El aprendizaje no supervizado es una clase de técnica de aprendizaje automático para descrubrir patrones en los datos. Por ejemplo:</p>
<ul>
<li><p>Encontrar los grupos naturales de clientes en función de sus historiales de compras o buscar:</p></li>
<li><p>Patrones y correlaciones entre estas compras, y utilizar estos patrones para expresar los datos en forma comprimida.</p></li>
</ul>
<p>Estos son ejemplos de técnicas de aprendizaje no supervizadas llamadas <em>agrupación</em> y <em>reducción de dimensiones.</em></p>
<blockquote class="blockquote">
<p>El aprendizaje no supervizado se define en oposición al aprendizaje supervizado.</p>
</blockquote>
<ul>
<li><p>Un ejemplo de <strong><em>aprendizaje supervisado</em></strong> es utilizar las medidas de los tumores para clasificarlos como benignos o cancerosos. En este caso, el descubrimiento de patrones es guiado o supervizado, de modo que los patrones son lo más utilies posible para predecir la etiqueta: benigno o canceroso.</p></li>
<li><p>El <strong><em>aprendizaje no supervisado</em></strong>, por el contrario, es un aprendizaje sin etiquetas. Es puro descubrimiento de patrones, sin la guía de una tarea de predicción.</p></li>
</ul>
<section id="iris-dataset" class="level3">
<h3 class="anchored" data-anchor-id="iris-dataset">Iris dataset</h3>
<p>El conjunto de datos iris consta de mediciones de muchas plantas iris de tres especies diferentes:</p>
<ul>
<li><p>Setosa</p></li>
<li><p>Versicolor</p></li>
<li><p>Virginica</p></li>
</ul>
<p>Hay cuatro medidas:</p>
<ol type="1">
<li><p>Largo de pétalo (Petal length)</p></li>
<li><p>Ancho de pétalo (Petal width)</p></li>
<li><p>Largo de sépalo (Sepal length)</p></li>
<li><p>Ancho de sépalo (sepal width)</p></li>
</ol>
<p>Estas son las características del conjunto de datos.</p>
<section id="matrices-características-y-muestras" class="level4">
<h4 class="anchored" data-anchor-id="matrices-características-y-muestras">Matrices, características y muestras</h4>
<p>Conjuntos de datos como este (iris) se escribiran como matrices numerosas bidimensionales.</p>
<ul>
<li><p>Las columnas de la matriz corresponderán a las características.</p></li>
<li><p>Las medidas de plantas individuales son las muestras del conjunto de datos, estas corresponden a filas de la matriz.</p></li>
</ul>
</section>
<section id="iris-datases-es-4-dimensional" class="level4">
<h4 class="anchored" data-anchor-id="iris-datases-es-4-dimensional">Iris datases es 4-dimensional</h4>
<p>Las muestras del conjunto de datos iris tienen cuatro medidas y, por lo tanto, corresponden a puntos en un espacio de cuatro dimensiones. Es decir:</p>
<ul>
<li>Dimensiones = número de características o features.</li>
</ul>
<p>No podemos visualizar cuatro dimensiones directamente, pero utilizando técnicas de aprendizaje no supervizado aún podemos obtener información.</p>
</section>
</section>
<section id="k-means-clustering" class="level3">
<h3 class="anchored" data-anchor-id="k-means-clustering">K-Means Clustering</h3>
<p>Agruparemos estas muestras utilizando la agrupación de k-Means. K-Means encuentra un número específico de grupos en las muestras. Está implementado en la biblioteca de <code>scikit-learn</code> o <code>sklearn</code>.</p>
<p>Veamos KMeans en acción con el conjunto de datos iris.</p>
<div id="15964fad" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd         </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn <span class="im">import</span> datasets    <span class="co"># Librería utilizada para importar iris dataset</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>iris <span class="op">=</span> datasets.load_iris()     <span class="co"># importamos el conjunto de datos iris</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>iris <span class="op">=</span> pd.DataFrame(iris.data, columns <span class="op">=</span> iris.feature_names) <span class="co"># Convertimos iris a dataframe</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Para comenzar:</p>
<ol type="1">
<li><p>Importamos KMeans de scikit-learn.</p></li>
<li><p>Luego creamos un modelo KMeans, especificando la cantidad de clústeres que deseamos encontrar con <code>n_clusters</code> especificamos n_cluster = 3, ya que hay tres especies de iris.</p></li>
<li><p>Posteriormente, llamamos el método de ajuste del modelo <code>.fit()</code>, pasando la matriz del iris dataset. Esto ajusta el modelo a los datos, localizando y recordando las regiones donde ocurren los diferentes grupos.</p></li>
<li><p>Por último, podemos utilizar el método de predicción del modelo en este mismo conjunto de datos.</p></li>
</ol>
<div id="7b938af7" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.cluster <span class="im">import</span> KMeans</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> KMeans(n_clusters <span class="op">=</span> <span class="dv">3</span>, random_state <span class="op">=</span> <span class="dv">42</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>model.fit(iris)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<style>#sk-container-id-1 {
  /* Definition of color scheme common for light and dark mode */
  --sklearn-color-text: #000;
  --sklearn-color-text-muted: #666;
  --sklearn-color-line: gray;
  /* Definition of color scheme for unfitted estimators */
  --sklearn-color-unfitted-level-0: #fff5e6;
  --sklearn-color-unfitted-level-1: #f6e4d2;
  --sklearn-color-unfitted-level-2: #ffe0b3;
  --sklearn-color-unfitted-level-3: chocolate;
  /* Definition of color scheme for fitted estimators */
  --sklearn-color-fitted-level-0: #f0f8ff;
  --sklearn-color-fitted-level-1: #d4ebff;
  --sklearn-color-fitted-level-2: #b3dbfd;
  --sklearn-color-fitted-level-3: cornflowerblue;

  /* Specific color for light theme */
  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));
  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-icon: #696969;

  @media (prefers-color-scheme: dark) {
    /* Redefinition of color scheme for dark theme */
    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));
    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-icon: #878787;
  }
}

#sk-container-id-1 {
  color: var(--sklearn-color-text);
}

#sk-container-id-1 pre {
  padding: 0;
}

#sk-container-id-1 input.sk-hidden--visually {
  border: 0;
  clip: rect(1px 1px 1px 1px);
  clip: rect(1px, 1px, 1px, 1px);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  width: 1px;
}

#sk-container-id-1 div.sk-dashed-wrapped {
  border: 1px dashed var(--sklearn-color-line);
  margin: 0 0.4em 0.5em 0.4em;
  box-sizing: border-box;
  padding-bottom: 0.4em;
  background-color: var(--sklearn-color-background);
}

#sk-container-id-1 div.sk-container {
  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`
     but bootstrap.min.css set `[hidden] { display: none !important; }`
     so we also need the `!important` here to be able to override the
     default hidden behavior on the sphinx rendered scikit-learn.org.
     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */
  display: inline-block !important;
  position: relative;
}

#sk-container-id-1 div.sk-text-repr-fallback {
  display: none;
}

div.sk-parallel-item,
div.sk-serial,
div.sk-item {
  /* draw centered vertical line to link estimators */
  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));
  background-size: 2px 100%;
  background-repeat: no-repeat;
  background-position: center center;
}

/* Parallel-specific style estimator block */

#sk-container-id-1 div.sk-parallel-item::after {
  content: "";
  width: 100%;
  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);
  flex-grow: 1;
}

#sk-container-id-1 div.sk-parallel {
  display: flex;
  align-items: stretch;
  justify-content: center;
  background-color: var(--sklearn-color-background);
  position: relative;
}

#sk-container-id-1 div.sk-parallel-item {
  display: flex;
  flex-direction: column;
}

#sk-container-id-1 div.sk-parallel-item:first-child::after {
  align-self: flex-end;
  width: 50%;
}

#sk-container-id-1 div.sk-parallel-item:last-child::after {
  align-self: flex-start;
  width: 50%;
}

#sk-container-id-1 div.sk-parallel-item:only-child::after {
  width: 0;
}

/* Serial-specific style estimator block */

#sk-container-id-1 div.sk-serial {
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: var(--sklearn-color-background);
  padding-right: 1em;
  padding-left: 1em;
}


/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is
clickable and can be expanded/collapsed.
- Pipeline and ColumnTransformer use this feature and define the default style
- Estimators will overwrite some part of the style using the `sk-estimator` class
*/

/* Pipeline and ColumnTransformer style (default) */

#sk-container-id-1 div.sk-toggleable {
  /* Default theme specific background. It is overwritten whether we have a
  specific estimator or a Pipeline/ColumnTransformer */
  background-color: var(--sklearn-color-background);
}

/* Toggleable label */
#sk-container-id-1 label.sk-toggleable__label {
  cursor: pointer;
  display: flex;
  width: 100%;
  margin-bottom: 0;
  padding: 0.5em;
  box-sizing: border-box;
  text-align: center;
  align-items: start;
  justify-content: space-between;
  gap: 0.5em;
}

#sk-container-id-1 label.sk-toggleable__label .caption {
  font-size: 0.6rem;
  font-weight: lighter;
  color: var(--sklearn-color-text-muted);
}

#sk-container-id-1 label.sk-toggleable__label-arrow:before {
  /* Arrow on the left of the label */
  content: "▸";
  float: left;
  margin-right: 0.25em;
  color: var(--sklearn-color-icon);
}

#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {
  color: var(--sklearn-color-text);
}

/* Toggleable content - dropdown */

#sk-container-id-1 div.sk-toggleable__content {
  max-height: 0;
  max-width: 0;
  overflow: hidden;
  text-align: left;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-1 div.sk-toggleable__content.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-1 div.sk-toggleable__content pre {
  margin: 0.2em;
  border-radius: 0.25em;
  color: var(--sklearn-color-text);
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-1 div.sk-toggleable__content.fitted pre {
  /* unfitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {
  /* Expand drop-down */
  max-height: 200px;
  max-width: 100%;
  overflow: auto;
}

#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {
  content: "▾";
}

/* Pipeline/ColumnTransformer-specific style */

#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-1 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator-specific style */

/* Colorize estimator box */
#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-1 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

#sk-container-id-1 div.sk-label label.sk-toggleable__label,
#sk-container-id-1 div.sk-label label {
  /* The background is the default theme color */
  color: var(--sklearn-color-text-on-default-background);
}

/* On hover, darken the color of the background */
#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

/* Label box, darken color on hover, fitted */
#sk-container-id-1 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator label */

#sk-container-id-1 div.sk-label label {
  font-family: monospace;
  font-weight: bold;
  display: inline-block;
  line-height: 1.2em;
}

#sk-container-id-1 div.sk-label-container {
  text-align: center;
}

/* Estimator-specific */
#sk-container-id-1 div.sk-estimator {
  font-family: monospace;
  border: 1px dotted var(--sklearn-color-border-box);
  border-radius: 0.25em;
  box-sizing: border-box;
  margin-bottom: 0.5em;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-1 div.sk-estimator.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

/* on hover */
#sk-container-id-1 div.sk-estimator:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-1 div.sk-estimator.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Specification for estimator info (e.g. "i" and "?") */

/* Common style for "i" and "?" */

.sk-estimator-doc-link,
a:link.sk-estimator-doc-link,
a:visited.sk-estimator-doc-link {
  float: right;
  font-size: smaller;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1em;
  height: 1em;
  width: 1em;
  text-decoration: none !important;
  margin-left: 0.5em;
  text-align: center;
  /* unfitted */
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
  color: var(--sklearn-color-unfitted-level-1);
}

.sk-estimator-doc-link.fitted,
a:link.sk-estimator-doc-link.fitted,
a:visited.sk-estimator-doc-link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
div.sk-estimator:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover,
div.sk-label-container:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover,
div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

/* Span, style for the box shown on hovering the info icon */
.sk-estimator-doc-link span {
  display: none;
  z-index: 9999;
  position: relative;
  font-weight: normal;
  right: .2ex;
  padding: .5ex;
  margin: .5ex;
  width: min-content;
  min-width: 20ex;
  max-width: 50ex;
  color: var(--sklearn-color-text);
  box-shadow: 2pt 2pt 4pt #999;
  /* unfitted */
  background: var(--sklearn-color-unfitted-level-0);
  border: .5pt solid var(--sklearn-color-unfitted-level-3);
}

.sk-estimator-doc-link.fitted span {
  /* fitted */
  background: var(--sklearn-color-fitted-level-0);
  border: var(--sklearn-color-fitted-level-3);
}

.sk-estimator-doc-link:hover span {
  display: block;
}

/* "?"-specific style due to the `<a>` HTML tag */

#sk-container-id-1 a.estimator_doc_link {
  float: right;
  font-size: 1rem;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1rem;
  height: 1rem;
  width: 1rem;
  text-decoration: none;
  /* unfitted */
  color: var(--sklearn-color-unfitted-level-1);
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
}

#sk-container-id-1 a.estimator_doc_link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
#sk-container-id-1 a.estimator_doc_link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

#sk-container-id-1 a.estimator_doc_link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
}
</style><div id="sk-container-id-1" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>KMeans(n_clusters=3, random_state=42)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-1" type="checkbox" checked=""><label for="sk-estimator-id-1" class="sk-toggleable__label fitted sk-toggleable__label-arrow"><div><div>KMeans</div></div><div><a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.6/modules/generated/sklearn.cluster.KMeans.html">?<span>Documentation for KMeans</span></a><span class="sk-estimator-doc-link fitted">i<span>Fitted</span></span></div></label><div class="sk-toggleable__content fitted"><pre>KMeans(n_clusters=3, random_state=42)</pre></div> </div></div></div></div>
</div>
</div>
<div id="35544bf7" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> model.predict(iris)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>species_ <span class="op">=</span> labels</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(labels)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 0 2 0 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
 2 2 2 0 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 0 2 0 0 0 0 2 0 0 0 0
 0 0 2 2 0 0 0 0 2 0 2 0 2 0 0 2 2 0 0 0 0 0 2 0 0 0 0 2 0 0 0 2 0 0 0 2 0
 0 2]</code></pre>
</div>
</div>
<p>Esto nos devuelve una etiqueta de grupo para cada muestra, que indica a qué grupo pertenece una muestra.</p>
<section id="etiquetas-de-clúster-para-nuevas-muestras" class="level4">
<h4 class="anchored" data-anchor-id="etiquetas-de-clúster-para-nuevas-muestras">Etiquetas de clúster para nuevas muestras</h4>
<p>Si alguien viene con un algún dataset iris nuevo, kMeans puede determinar a qué grupos pertenecen sin tener que empezar de nuevo.</p>
<p>KMeans hace esto recordando la media (o promedio) de las muestras en cada grupo. Estos se llaman <strong>centroides</strong> se asignan nuevas muestras al grupo cuyo centroide esté más cercano.</p>
<p>Voy a tomar 3 registros aleatorios del dataset iris y asumiremos que estas son muestras nuevas.</p>
<div id="4540d628" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>new_samples <span class="op">=</span> iris.sample(n <span class="op">=</span> <span class="dv">3</span>, random_state <span class="op">=</span> <span class="dv">42</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(new_samples)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     sepal length (cm)  sepal width (cm)  petal length (cm)  petal width (cm)
73                 6.1               2.8                4.7               1.2
18                 5.7               3.8                1.7               0.3
118                7.7               2.6                6.9               2.3</code></pre>
</div>
</div>
<p>Para asignar las nuevas muestras a los grupos existentes, pasaremos el conjunto de nueva muestra al método de predicción del modelo kmeans.</p>
<div id="b3da6edf" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>new_labels <span class="op">=</span> model.predict(new_samples)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(new_labels)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[2 1 0]</code></pre>
</div>
</div>
<p>Como puede observar, esto devuelve las etiquetas de grupo para los datos nuevos o muestra de datos nueva.</p>
<blockquote class="blockquote">
<p>En la siguiente sección aprenderá cómo evaluar la calidad de su agrupación.</p>
</blockquote>
</section>
<section id="scatter-plots" class="level4">
<h4 class="anchored" data-anchor-id="scatter-plots">Scatter Plots</h4>
<p>Por ahora, visualizaremos nuestra agrupación de las muestras de iris usando diagramas de dispersión. A continuación se muestra un diagrama de dispersión de la longitud del sépalo frente a la longitud del pétalo del dataset iris.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/fig1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="300"></p>
</figure>
</div>
<p>Cada punto representa una muestra de iris y está coloreada según el grupo de la muestra. Para crear un diagrama de dispersión como este, usaremos <code>PyPlot</code>.</p>
<ul>
<li><p>La longitud del sépalo está en la columna 0 de la matriz iris, mientras que la longitud de los pétalos está en la segunda columna.</p></li>
<li><p>Y labels o etiquetas que encontramos previamente lo usamos para colorear por etiqueta de clúster como un paramétro en <code>.scatter()</code>.</p></li>
</ul>
<div id="392c0adb" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>xs <span class="op">=</span> iris.iloc[:, <span class="dv">0</span>]   <span class="co"># Longitud de los sépalos </span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>ys <span class="op">=</span> iris.iloc[:, <span class="dv">2</span>]   <span class="co"># Longitud de los pétalos</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>plt.scatter(xs, ys, c <span class="op">=</span> labels)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-7-output-1.png" width="558" height="411" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Ahora, calculemos las coordenadas de los centroides utilizando el atributo <code>.cluster_centers_</code> de <code>model</code>. y asignaremos la columna 0 de <code>centroids</code> a <code>centroids_x</code>, y la columna 2 de <code>centroids</code> a <code>centroids_y</code>. Posterior a ello, realizaremos un diagrama de dispersión de centroids_x y centroids_y, utilizando <code>marker = 'D'</code> (un rombo) como marcador especificando el parámetro marker. El tamaño de los marcadores en 50 utilizando <code>s = 50</code>.</p>
<div id="83601dd7" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>xs <span class="op">=</span> iris.iloc[:, <span class="dv">0</span>]   <span class="co"># Longitud de los sépalos </span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>ys <span class="op">=</span> iris.iloc[:, <span class="dv">2</span>]   <span class="co"># Longitud de los pétalos</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>plt.scatter(xs, ys, c <span class="op">=</span> labels, alpha <span class="op">=</span> <span class="fl">0.5</span>)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>centroids <span class="op">=</span> model.cluster_centers_</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>centroids_x <span class="op">=</span> centroids[:,<span class="dv">0</span>]</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>centroids_y <span class="op">=</span> centroids[:,<span class="dv">2</span>]</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>plt.scatter(centroids_x, centroids_y, marker <span class="op">=</span> <span class="st">'D'</span>, s <span class="op">=</span> <span class="dv">50</span>)</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-8-output-1.png" width="558" height="411" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="evaluar-una-agrupación" class="level2">
<h2 class="anchored" data-anchor-id="evaluar-una-agrupación">Evaluar una agrupación</h2>
<p>En la sección anterior, utilizamos KMeans para agrupar el dataset de iris en tres grupos. Pero <strong>¿cómo podemos evaluar la calidad de esta agrupación?</strong></p>
<p>Un enfoque directo es comparar los grupos con las especies de iris. Primero aprenderá sobre esto, antes de considerar el problema de cómo medir la calidad de una agrupación de una manera que no requiera que nuestras muestras vengan preagrupadas en especies. Esta medida de calidad puede utilizarse más adelante para tomar una decisión informada sobre el número de conglomerados a buscar.</p>
<section id="iris-clusters-vs-especies" class="level3">
<h3 class="anchored" data-anchor-id="iris-clusters-vs-especies">Iris: Clusters vs Especies</h3>
<p>En primer lugar, comprobemos si los 3 grupos de muestras de iris tienen alguna correspondencia con la especie de iris.</p>
<p>La correspondencia se describe en esta tabla:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/fig2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="400"></p>
</figure>
</div>
<p>Existe una columna para cada una de las tres especies de iris: setosa, versicolor y virginica, y una fila para cada una de las tres etiquetas de grupo: 0, 1 y 2.</p>
<p>La tabla muestra el número de muestras que tienen cada combinación posible de etiquetas de grupo/especie. Por ejemplo:</p>
<ul>
<li><p>Vemos que el grupo 0 se corresponde perfectamente con la especie setosa.</p></li>
<li><p>Por otro lado, mientras que el cluster 1 contiene principalmente muestras de virginica en el grupo 2.</p></li>
</ul>
<p>Tablass como esta, se denominan <strong>tabulaciones cruzadas</strong> o <strong>Cross tabulation</strong></p>
</section>
<section id="cross-tabulation-con-pandas" class="level3">
<h3 class="anchored" data-anchor-id="cross-tabulation-con-pandas">Cross Tabulation con Pandas</h3>
<p>Para construir uno, usareos la biblioteca <code>pandas.</code> Como podemos observar en el bloque de código siguiente, creamos un dataframe de dos columnas, donde la primera columna son las etiquetas del grupo y la segunda son las especies de iris, de modo que cada fila proporciona la etiqueta del grupo y la especie de una sola muestra.</p>
<div id="1f7fc404" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>iris_raw <span class="op">=</span> datasets.load_iris() </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>iris <span class="op">=</span> pd.DataFrame(iris_raw.data, columns <span class="op">=</span> iris_raw.feature_names)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Agregamos columna de especie verdadera al dataframe iiris</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>species <span class="op">=</span> pd.Categorical.from_codes(iris_raw.target, iris_raw.target_names)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame({<span class="st">'labels'</span>:labels, <span class="st">'species'</span>:species})</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     labels    species
0         1     setosa
1         1     setosa
2         1     setosa
3         1     setosa
4         1     setosa
..      ...        ...
145       0  virginica
146       2  virginica
147       0  virginica
148       0  virginica
149       2  virginica

[150 rows x 2 columns]</code></pre>
</div>
</div>
<p>Ahora usamos la función de tabla cruzuda de pandas para crear la tubulación cruzada, pasando las dos columnas del DataFrame.</p>
<div id="04c0d743" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>ct <span class="op">=</span> pd.crosstab(df[<span class="st">'labels'</span>], df[<span class="st">'species'</span>])</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(ct)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>species  setosa  versicolor  virginica
labels                                
0             0           3         36
1            50           0          0
2             0          47         14</code></pre>
</div>
</div>
<p>Tabulaciones cruzadas como estás proporcionan información valiosa sobre qué tipo de muestras se encuentran en qué grupo. Pero la mayoría de los conjuntos de datos, las muestras no están etiquetadas por especie.</p>
<p><strong>¿Cómo se puede evaluar la calidad de un clustering en estos casos?</strong></p>
</section>
<section id="medición-de-la-calidad-de-la-agrupación" class="level3">
<h3 class="anchored" data-anchor-id="medición-de-la-calidad-de-la-agrupación">Medición de la calidad de la agrupación</h3>
<p>Una buena agrupación tiene grupos compactos, lo que significa que las muestras de cada grupo están agrupadas, no dispersas.</p>
<p>La <strong>inercia</strong> puede medir la distribución de las muestras dentro de cada grupo. Intuitivamente, la inercia mide qué tan lejos están las muestras de sus centroides. Puede encontrar la definición precisa en la documentación de scikit-learn. Queremos grupos que no estén dispersos, por lo que los valores más bajos de inercia son mejores.</p>
<p>La inercia de un modelo KMeans se mide automaticamente cuando se llama al metodo de ajuste .fit y luego están disponibles como atributos de <code>inertia_</code>.</p>
<p>De hecho, KMeans pretende colocar los clusters de forma que se minimice la inercia.</p>
<div id="f4998667" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> KMeans(n_clusters <span class="op">=</span> <span class="dv">3</span>, random_state <span class="op">=</span> <span class="dv">42</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>model.fit(iris)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(model.inertia_)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>78.8556658259773</code></pre>
</div>
</div>
<p>A continuación se muestra un gráfico de los valores de inercia de las agrupaciones del conjunto de datos de iris con diferentes números de agrupaciones.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/fig3.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="400"></p>
</figure>
</div>
<p>Nuestro modelo KMeans con 3 grupos tiene una inercia relativamente baja, lo cual es genial. Pero observe que la incercia continúa disminuyendo lentamente. Entonces, <strong>¿cuál es la mejor cantidad de clústeres para elegir?</strong> En última instacia se trata de una compensación.</p>
<p>Una buena agrupación tiene agrupaciones estrechas (lo que significa inercia baja). Pero tampoco tiene demasiados grupos.</p>
<p>Una buena regla general es elegir un codo en el gráfico de inercia, es decir, un punto donde la inercia comienza a disminuir más lentamente.</p>
<p>Por ejemplo, según este criterio, 3 es un buen número de grupos para el conjunto de datos del iris.</p>
<div id="70a89445" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>ks <span class="op">=</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">11</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>inertias <span class="op">=</span> []</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> k <span class="kw">in</span> ks:</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> KMeans(n_clusters<span class="op">=</span>k, random_state<span class="op">=</span><span class="dv">42</span>)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    model.fit(iris)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    inertias.append(model.inertia_)   <span class="co"># suma de distancias cuadradas intracluster</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>plt.plot(ks, inertias, <span class="st">'-o'</span>)</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'número de clusters'</span>)</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'inertia'</span>)</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>plt.xticks(ks)</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-12-output-1.png" width="593" height="429" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="transformación-de-características-para-mejorar-agrupaciones" class="level2">
<h2 class="anchored" data-anchor-id="transformación-de-características-para-mejorar-agrupaciones">Transformación de Características para mejorar agrupaciones</h2>
<p>Veamos ahora otro conjunto de datos, el conjunto de datos de los vinos del Piamonte.</p>
<ul>
<li><p>Disponemos de 178 muestras de vino tinto de la región de Piamonte de Italia.</p></li>
<li><p>Las entradas o features miden la composición química (como el contendio del alcohol) y propiedades visuales como la intensidad del color.</p></li>
<li><p>Las muestras proceden de 3 variedades distintas de vino.</p></li>
</ul>
<div id="43801fe5" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> pd.read_csv(<span class="st">"wine.csv"</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>varieties <span class="op">=</span> samples[<span class="st">'class_name'</span>]</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> samples.drop(<span class="st">"class_name"</span>, axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>samples</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">class_label</th>
<th data-quarto-table-cell-role="th">alcohol</th>
<th data-quarto-table-cell-role="th">malic_acid</th>
<th data-quarto-table-cell-role="th">ash</th>
<th data-quarto-table-cell-role="th">alcalinity_of_ash</th>
<th data-quarto-table-cell-role="th">magnesium</th>
<th data-quarto-table-cell-role="th">total_phenols</th>
<th data-quarto-table-cell-role="th">flavanoids</th>
<th data-quarto-table-cell-role="th">nonflavanoid_phenols</th>
<th data-quarto-table-cell-role="th">proanthocyanins</th>
<th data-quarto-table-cell-role="th">color_intensity</th>
<th data-quarto-table-cell-role="th">hue</th>
<th data-quarto-table-cell-role="th">od280</th>
<th data-quarto-table-cell-role="th">proline</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>14.23</td>
<td>1.71</td>
<td>2.43</td>
<td>15.6</td>
<td>127</td>
<td>2.80</td>
<td>3.06</td>
<td>0.28</td>
<td>2.29</td>
<td>5.64</td>
<td>1.04</td>
<td>3.92</td>
<td>1065</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1</td>
<td>13.20</td>
<td>1.78</td>
<td>2.14</td>
<td>11.2</td>
<td>100</td>
<td>2.65</td>
<td>2.76</td>
<td>0.26</td>
<td>1.28</td>
<td>4.38</td>
<td>1.05</td>
<td>3.40</td>
<td>1050</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>1</td>
<td>13.16</td>
<td>2.36</td>
<td>2.67</td>
<td>18.6</td>
<td>101</td>
<td>2.80</td>
<td>3.24</td>
<td>0.30</td>
<td>2.81</td>
<td>5.68</td>
<td>1.03</td>
<td>3.17</td>
<td>1185</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>1</td>
<td>14.37</td>
<td>1.95</td>
<td>2.50</td>
<td>16.8</td>
<td>113</td>
<td>3.85</td>
<td>3.49</td>
<td>0.24</td>
<td>2.18</td>
<td>7.80</td>
<td>0.86</td>
<td>3.45</td>
<td>1480</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>1</td>
<td>13.24</td>
<td>2.59</td>
<td>2.87</td>
<td>21.0</td>
<td>118</td>
<td>2.80</td>
<td>2.69</td>
<td>0.39</td>
<td>1.82</td>
<td>4.32</td>
<td>1.04</td>
<td>2.93</td>
<td>735</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">173</td>
<td>3</td>
<td>13.71</td>
<td>5.65</td>
<td>2.45</td>
<td>20.5</td>
<td>95</td>
<td>1.68</td>
<td>0.61</td>
<td>0.52</td>
<td>1.06</td>
<td>7.70</td>
<td>0.64</td>
<td>1.74</td>
<td>740</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">174</td>
<td>3</td>
<td>13.40</td>
<td>3.91</td>
<td>2.48</td>
<td>23.0</td>
<td>102</td>
<td>1.80</td>
<td>0.75</td>
<td>0.43</td>
<td>1.41</td>
<td>7.30</td>
<td>0.70</td>
<td>1.56</td>
<td>750</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">175</td>
<td>3</td>
<td>13.27</td>
<td>4.28</td>
<td>2.26</td>
<td>20.0</td>
<td>120</td>
<td>1.59</td>
<td>0.69</td>
<td>0.43</td>
<td>1.35</td>
<td>10.20</td>
<td>0.59</td>
<td>1.56</td>
<td>835</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">176</td>
<td>3</td>
<td>13.17</td>
<td>2.59</td>
<td>2.37</td>
<td>20.0</td>
<td>120</td>
<td>1.65</td>
<td>0.68</td>
<td>0.53</td>
<td>1.46</td>
<td>9.30</td>
<td>0.60</td>
<td>1.62</td>
<td>840</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">177</td>
<td>3</td>
<td>14.13</td>
<td>4.10</td>
<td>2.74</td>
<td>24.5</td>
<td>96</td>
<td>2.05</td>
<td>0.76</td>
<td>0.56</td>
<td>1.35</td>
<td>9.20</td>
<td>0.61</td>
<td>1.60</td>
<td>560</td>
</tr>
</tbody>
</table>

<p>178 rows × 14 columns</p>
</div>
</div>
</div>
<section id="clustering-con-vinos" class="level3">
<h3 class="anchored" data-anchor-id="clustering-con-vinos">Clustering con Vinos</h3>
<p>Tomaremos la matriz de muestra de los vinos y usaremos KMeans para encontrar 3 grupos</p>
<div id="743ff047" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> KMeans(n_clusters <span class="op">=</span> <span class="dv">3</span>, random_state <span class="op">=</span> <span class="dv">42</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> model.fit_predict(samples)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="cluster-vs-varieties" class="level4">
<h4 class="anchored" data-anchor-id="cluster-vs-varieties">Cluster vs Varieties</h4>
<p>Hay tres variedades de vinom así que usamos pandas para crear la tabla cruzada para comprobar las correspondencia entre la etiqueta del clúster y la variedad de vino.</p>
<div id="baaa1ef4" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame({<span class="st">'labels'</span>: labels, <span class="st">'varieties'</span>:varieties})</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>ct <span class="op">=</span> pd.crosstab(df[<span class="st">'labels'</span>], df[<span class="st">'varieties'</span>])</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(ct)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>varieties  Barbera  Barolo  Grignolino
labels                                
0               37       1          64
1               11      31           7
2                0      27           0</code></pre>
</div>
</div>
<p>Como podemos ver, esta vez las cosas no han salido tan bien. Los clusters KMeans no se corresponden bien con las variedades de vino.</p>
</section>
<section id="variación-de-características" class="level4">
<h4 class="anchored" data-anchor-id="variación-de-características">Variación de Características</h4>
<p>El problema es que las características del conjunto de datos del vino tiene variaciones muy diferentes.</p>
<blockquote class="blockquote">
<p>La varianza de una característica mide la dispersión de sus valores</p>
</blockquote>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/fig4.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="400"></p>
</figure>
</div>
<p>Por ejemplo, la característica del ácido málico (<code>malic_acid</code>) tiene una mayor varianza que la característica <code>0d280</code>, y esto también se puede ver en su diagrama de dispersión.</p>
<p>Las diferencias en algunas de las variaciones de características son enormes, por ejmplo, en el diagrama de dispersión de características <code>od280</code> y <code>prolina</code>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/fig5.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="300"></p>
</figure>
</div>
</section>
</section>
<section id="standarscaler" class="level3">
<h3 class="anchored" data-anchor-id="standarscaler">StandarScaler</h3>
<p>En la agrupación en clústeres de KMeans, la varianza de una característica corresponde a su influencia en el algoritmo de agrupación en clústeres. Es decir:</p>
<ul>
<li><div>
<blockquote class="blockquote">
<p>Varianza de Carasterística = Influencia de Característica</p>
</blockquote>
</div></li>
</ul>
<p>Para darle una oportunidad a cada característica, los datos deben transformarce para que las características tengan la misma varianza. Esto se puede lograr con el <code>StandarScaler</code> de scikit-learn. Transforma cada característica para que tenga media 0 y varianza 1.</p>
<p>Las características <strong>estandarizadas</strong> resultantes pueden ser muy informativas.</p>
<p>Si utilizamos, por ejemplo, los valores estandarizados de <code>od280</code> y <code>proline</code>, las tres variedades de vino son mucho más distintas.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/fig6.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="800"></p>
</figure>
</div>
<p>Veamos StandarScaler en acción:</p>
<div id="a2b49f8c" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> StandardScaler() <span class="co"># Creamos el objeto StandarScaler </span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>scaler.fit(samples)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>StandardScaler(copy <span class="op">=</span> <span class="va">True</span>, with_mean <span class="op">=</span> <span class="va">True</span>, with_std <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>samples_scaled <span class="op">=</span> scaler.transform(samples)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>El método de transformación ahora se puede utilizar para estandarizar cualquier muestra, ya sean las mismas o completamente nuevas.</p>
<section id="métodos-similares" class="level4">
<h4 class="anchored" data-anchor-id="métodos-similares">Métodos similares</h4>
<blockquote class="blockquote">
<p>Las API de StandarScaler y KMeans son similares, pero hay una diferencia importante:</p>
<ul>
<li><p>StandardScaler transforma datos y por eso tiene un método de transformación.</p></li>
<li><p>KMeans por el contrario, asigna etiquetas de clúster a las muestras y esto se hace utilizando el método de predicción.</p></li>
</ul>
</blockquote>
</section>
</section>
<section id="standardscaler-luego-kmeans" class="level3">
<h3 class="anchored" data-anchor-id="standardscaler-luego-kmeans">StandardScaler luego KMeans</h3>
<p>Volvamos al problema del agrupamiento de los vinos. Necesitamos realizar dos pasos:</p>
<ol type="1">
<li><p>Estandarizar los datos utilizando StandardScaler y</p></li>
<li><p>Tomar los datos estandarizados y agruparlos utilizando KMeans</p></li>
</ol>
<p>Esto se hace fácilmente combinando los dos pasos mediante un pipeline de scikit-learn, luego, los datos fluyen de un paso al siguiente de forma automática.</p>
<section id="pipelines-combinando-multiples-pasos" class="level4">
<h4 class="anchored" data-anchor-id="pipelines-combinando-multiples-pasos">Pipelines combinando multiples pasos</h4>
<div id="44f5f950" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.cluster <span class="im">import</span> KMeans</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.pipeline <span class="im">import</span> make_pipeline</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> StandardScaler()</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>kmeans <span class="op">=</span> KMeans(n_clusters <span class="op">=</span> <span class="dv">3</span>, random_state <span class="op">=</span> <span class="dv">42</span>)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Aplicamos los pasos que queremos combinar</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>pipeline <span class="op">=</span> make_pipeline(scaler, kmeans)</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>pipeline.fit(samples)</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Utilizamos el método de predicción para obtener las etiquetas del clúster</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> pipeline.predict(samples)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Ahora, realicemos la comprobación de la correspondencia entre las etiquetas de los cluster y las variedadesd de vino</p>
<div id="70d5a1e2" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame({<span class="st">'labels'</span>: labels, <span class="st">'varieties'</span>:varieties})</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>ct <span class="op">=</span> pd.crosstab(df[<span class="st">'labels'</span>], df[<span class="st">'varieties'</span>])</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(ct)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>varieties  Barbera  Barolo  Grignolino
labels                                
0                0       0          67
1               48       0           1
2                0      59           3</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Y como podemos observar, esto nos revela que al incorporar estandarización la nueva agrupación es fantástica. Sus tres clúster corresponden casi exactamente a las tres variedades de vino. Por tanto, esto es una gran mejora con respecto a la agrupación sin estandarización.</p>
</blockquote>
<p><strong>StandardScaler</strong> es un ejemplo de un paso de <em>preprocesamiento</em>. Existen varios de estos disponibles en Scikit-Learn, por ejemplo, MaxAbsScaler y Normalizer.</p>
</section>
</section>
</section>
</section>
<section id="visualización-con-agrupamiento-jerárquico-y-t-sne" class="level1">
<h1><strong>Visualización con agrupamiento Jerárquico y t-SNE</strong></h1>
<p>En este capítulo, aprenderás dos técnicas de aprendizaje no suprvisado para la visualización de datos: la <strong>agrupación jerárquica</strong> y <strong>t-SNE</strong>.</p>
<p><strong>La agrupación jerárquica</strong> fusiona las muestras de datos en grupos cada vez más amplios, lo que da como resultado una visualización en forma de árbol de la jerarquía de grupos resultantes.</p>
<p><strong>t-SNE</strong> mapea las muestras de datos en un espacio bidimensional para que se pueda visualizar la proximidad antre ellas.</p>
<section id="visualizar-jerarquías" class="level2">
<h2 class="anchored" data-anchor-id="visualizar-jerarquías">Visualizar Jerarquías</h2>
<p>Una gran parte del trabajo de cualquier cientifico de datos es la comunicación de los resultados o conocimiento a otras personas. Las visualizaciones son una excelente manera de compartir sus hallazgos especialmente con una audiencia no técnica. En este nuevo capítulo, aprenderá sobre dos métodos de aprendizaje no supervisado correspondientes a visualización:</p>
<ul>
<li><p>t-SNE</p></li>
<li><p>Agrupamiento Jerárquico</p></li>
</ul>
<p><strong>t-SNE</strong>, que lo veremos más adelante, crea un mapa 2D de cualquier conjunto de datos y transmite información útil sobre la proximidad de las muestras entre sí. Pero primero aprendamos sobre la agrupación jerárquica.</p>
<p>Ya has visto muchas agrupaciones jerárquicas en el mundo real. Por ejemplo, los seres vivos pueden organizarse en grupos pequeños y estrechos como los humanos, los simios, las serpientes y los lagartos, o en grupos más grandes y amplios, como los mamíferos y los reptiles, o incluso grupos más amplios, como los animales y las plantas. Como puede visualizar en la figura de abajo, estos grupos están contenidos unos dentro de otros y forman una jerarquía.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/fig7.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="450"></p>
</figure>
</div>
<p>De manera análoga, la agrupación jerárquica organiza las muestras en una jerarquía de grupos.</p>
<p>La <strong>agrupación jerárquica</strong> puede organizar cualquier tipo de datos en una jerarquía, no sólo muestras de plantas y animales.</p>
<section id="dataset-de-scoring-eurovision" class="level3">
<h3 class="anchored" data-anchor-id="dataset-de-scoring-eurovision">Dataset de scoring Eurovision</h3>
<p>Consideremos un nuevo tipo de conjunto de datos que describe cómo los países calificaron sus actuaciones en el Festival de la Canción de Eurovisión 2016. Los datos se organizan en una matriz rectangular, donde las filas de la matriz muestra cuántos puntos le dio un país a cada canción.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/fig8.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="400"></p>
</figure>
</div>
<p>Las <em>muestras</em> en este caso son los países. El resultado de aplicar la agrupación jerárquica al Festival de Eurovisión:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/fig9.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="500"></p>
</figure>
</div>
<p>Las puntuaciones se pueden visualizar como u diagrama en forma de árbol llamado <strong><em>dendrograma</em></strong>. Esta única imagen revela mucha información sobre el comportamiento electoral de los países en Eurovisión. El dendrograma agrupa a los países en grupos cada vez más grandes, y muchos de ellos los grupos se reconocen inmediatamente como compuestos por países cercanos entre si geográficamente, o que tienen estrechos vínculos culturales o político, o que pertenecen a un solo grupo linguístico. De esta manera, la agrupación jerárquica puede generar excelentes visualizaciones. <strong>¿Pero cómo funciona?</strong></p>
<p>La agrupación jerárquica se realiza en pasos:</p>
<ul>
<li><p>Al principio cada país es su propio clúster,por lo que hay tantos clústeres como países.</p></li>
<li><p>En cada paso se fusionan los dos clústeres más cercanos. Esto disminuye el número de clústeres, y</p></li>
<li><p>Al final, sólo queda un grupo, que contiene todos los países.</p></li>
</ul>
<p>Este proceso es en realidad un tipo particular de agrupamiento jerárquico llamdo <strong>agrupamiento aglomerativo,</strong> también existe el <strong>agrupamiento divisivo</strong>, que funciona a la inversa.</p>
<p>Aún no hemos definido qué significa que dos clústeres estén cerca, pero volveremos a abordar este tema más adelante.</p>
</section>
<section id="dendrograma-de-una-clusterización-jerárquica" class="level3">
<h3 class="anchored" data-anchor-id="dendrograma-de-una-clusterización-jerárquica">Dendrograma de una Clusterización Jerárquica</h3>
<p>Todo el proceso de agrupamiento jerárquico está codificado en el dendrograma.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/fig9.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="500"></p>
</figure>
</div>
<p>En la parte inferior, cada país se encuentra en un grupo propio. Luego el agrupamiento continúa desde abajo hacia arriba.</p>
<p>Los grupos se representan como líneas verticales y una unión de líneas verticales indica una fusión de grupos.</p>
<p>Para comprender mejor, hagamos un acercamiento:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/fig10.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="500"></p>
</figure>
</div>
<p>Observemos sólo una parte de este dendrograma,</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/fig11.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="174"></p>
</figure>
</div>
<p>Al principio hay seis grupos , cada uno de los cuales contiene sólo un país. La primera fusión se produce aquí:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/fig12.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="174"></p>
</figure>
</div>
<p>donde los grupos que contienen a Cyprus y Grecia se fusionan en un solo grupo. Posteriormente, este nuevo clúster se fusiona con el clúster que contiene Bulgaria:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/fig13.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="174"></p>
</figure>
</div>
<p>Poco después, los grupos que incluyen a Moldova y Rusia son fusionados,</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/fig14.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="174"></p>
</figure>
</div>
<p>que más tarde a su vez se fusiona con el grupo que contiene Armenia.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/fig15.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="174"></p>
</figure>
</div>
<p>Más tarde aún, los dos grupos compuestos se fusionan, Este proceso continua hasta que sólo quede un grupo, y éste contenga todos los países.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/fig16.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="500"></p>
</figure>
</div>
</section>
<section id="clusterización-jerárquica-con-scipy" class="level3">
<h3 class="anchored" data-anchor-id="clusterización-jerárquica-con-scipy">Clusterización Jerárquica con SciPy</h3>
<p>En el capítulo anterior, utilizamos la agrupación KMeans para agrupar empresas según los movimientos de sus cotizaciones bursátiles. Ahora, realizaremos la agrupación jerárquica de las empresas.</p>
<p>linkage() de SciPy realiza una agrupación jerárquica en una matriz de muestras.</p>
<div id="6a24a38d" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.cluster.hierarchy <span class="im">import</span> linkage, dendrogram</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> normalize</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>empresas <span class="op">=</span> pd.read_csv(<span class="st">"/Users/juanisaulamejia/Documents/webmathJI/posts/Unsupervised_Learning/empresas.csv"</span>)</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>companies <span class="op">=</span> empresas.iloc[:, <span class="dv">0</span>].tolist()</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>empresas <span class="op">=</span> empresas.select_dtypes(include<span class="op">=</span><span class="st">"number"</span>).copy()</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>arr <span class="op">=</span> empresas.to_numpy()</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>normalized_movements <span class="op">=</span> normalize(arr)</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the linkage: mergings</span></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>mergings <span class="op">=</span> linkage(normalized_movements, method <span class="op">=</span> <span class="st">'complete'</span>)</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the dendrogram</span></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>dendrogram(mergings, labels <span class="op">=</span> companies,</span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>leaf_rotation <span class="op">=</span> <span class="dv">90</span>,</span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>leaf_font_size <span class="op">=</span> <span class="dv">6</span>)</span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-19-output-1.png" width="571" height="550" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Como podemos observar, podemos crear visualizaciones geniales como esta con el clustering jerárquico, pero se puede usar ara más que solo visualizaciones.</p>
</section>
</section>
<section id="etiquetas-de-clústeres-en-la-agrupación-jerárquica" class="level2">
<h2 class="anchored" data-anchor-id="etiquetas-de-clústeres-en-la-agrupación-jerárquica">Etiquetas de clústeres en la agrupación jerárquica</h2>
<p>En la sección anterior empleamos la agrupación jerárquica. Creamos una gran visualización de las empresas según sus movimientos de sus cotizaciones bursátiles. Pero la <strong>agrupación jerárquica no es sólo una herramienta de visualización</strong>.</p>
<p>En esta sección aprenderá cómo extraer los clústeres de las etapas intermedias de una agrupación jerárquica. Las etiquetas de clúster para estos agrupamientos intermedios se pueden utilizar posteriormente en otros cálculos, como tabulaciones cruzadas, al igual que las etiquetas de clúster de KMeans.</p>
<section id="agrupaciones-intermedias-y-altura-en-el-dendrograma" class="level3">
<h3 class="anchored" data-anchor-id="agrupaciones-intermedias-y-altura-en-el-dendrograma">Agrupaciones intermedias y altura en el dendrograma</h3>
<p>Una etapa intermedia en la agrupación jerárquica se especifica eligiendo una altura en el dendrograma.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/fig17.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="200"></p>
</figure>
</div>
<p>Por ejemplo, elegir una altura de 15 define una agrupación en el que Bulgaria, Cyprus y Grecia están en un grupo, Rusia y Moldavia en otro, y Armenia en un grupo propio.</p>
<p>Pero <strong>¿qué significa la altura?</strong></p>
<p>El eje <code>y</code> del dendrograma codifica la distancia entre los grupos fusionados. Por ejemplo, la distancia entre el grupo que contiene Cyprus y el número de países que contenían Grecia era de aproximadamente 6 cuando se fusionaron en un solo grupo. Cuando este nuevo cúmulo se fusiono con el cúmulo que contenía a Bulgaria, la distancia entre ellos era de 12. Por lo tanto, la altura que especifica una agrupación intermedia corresponde a una distancia. Esto especifica que la agrupación jerárquica debe detenerse a fusionar clústeres cuando todos los clústeres están al menos a esta distancia.</p>
</section>
<section id="distancia-entre-clusters" class="level3">
<h3 class="anchored" data-anchor-id="distancia-entre-clusters">Distancia entre Clusters</h3>
<p>La distancia entre dos grupos se mide utilizando un <strong>método de enlace (método <code>linkage</code>).</strong> En nuestro ejemplo, utilizamos un enlace <strong>completo</strong>, donde la distancia entre dos clusteres es el máximo de las distancias entre sus muestras. Esto se especificó a través del parámetro “method” o en python <code>linkage(samples, method = "complete")</code>. Existen muchos otros métodos de vinculación y los veremos en algunos ejercicios que realizaremos en Python con Scikit-Learn.</p>
<blockquote class="blockquote">
<p>Los diferentes métodos de vinculación producen diferentes agrupaciones jerárquicas.</p>
</blockquote>
</section>
<section id="extracción-de-etiquetas-de-clúster-mediante-fcluster." class="level3">
<h3 class="anchored" data-anchor-id="extracción-de-etiquetas-de-clúster-mediante-fcluster.">Extracción de etiquetas de clúster mediante <code>fcluster.</code></h3>
<p>La etiquetas de clúster para cualquier etapa intermedia se pueden extraer utilizando la función <code>fcluster</code>. Vamos a probarlo, especificando la altura de 15. Despues de realizar la agrupación jerárquica de los datos de empresas, importamos la función <code>fcluster</code>. Luego, pasamos el resultado de la función de vinculación a la función fcluster, especificando la altura como segundo argumento.</p>
<div id="19bcf8e5" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.cluster.hierarchy <span class="im">import</span> linkage</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.cluster.hierarchy <span class="im">import</span> fcluster</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>mergings <span class="op">=</span> linkage(arr, method <span class="op">=</span> <span class="st">'complete'</span>)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>labels   <span class="op">=</span> fcluster(mergings, <span class="dv">15</span>, criterion <span class="op">=</span> <span class="st">'distance'</span>)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(labels)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[35 29 33 23  9 18 25 18  6 26  1 18  3 21 18 18 18 36 32 18 14 18 19 31
 18 11 20 27 10  7 34 15  4 18 18 30  8 18 10 18 11 28 16 17  5 18 18 18
 24 16 18 18 18 22 12 20 13  2 18 18]</code></pre>
</div>
</div>
<p>Esto nos devolvio una matriz numpy que contiene las etiquetas de clúster para todos los países.</p>
</section>
<section id="alineación-de-las-etiquetes-de-los-clústeres-con-los-nombres-de-las-empresas" class="level3">
<h3 class="anchored" data-anchor-id="alineación-de-las-etiquetes-de-los-clústeres-con-los-nombres-de-las-empresas">Alineación de las etiquetes de los clústeres con los nombres de las empresas</h3>
<p>Para inspeccionar las etiquetas de los clústeres, usaremos un DataFrame para alinear las etiquetas con los nombres de los países.</p>
<div id="fc0f2f68" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd </span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>pairs <span class="op">=</span> pd.DataFrame({<span class="st">'labels'</span>: labels, <span class="st">'companies'</span>: companies}) </span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(pairs.sort_values(<span class="st">'labels'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    labels                           companies
10       1                      ConocoPhillips
57       2                               Exxon
12       3                             Chevron
32       4                                  3M
44       5                        Schlumberger
8        6                         Caterpillar
29       7                     Lookheed Martin
36       8                    Northrop Grumman
4        9                              Boeing
38      10                               Pepsi
28      10                           Coca Cola
25      11                   Johnson &amp; Johnson
40      11                      Procter Gamble
54      12                            Walgreen
56      13                            Wal-Mart
20      14                          Home Depot
31      15                           McDonalds
42      16                   Royal Dutch Shell
49      16                               Total
43      17                                 SAP
46      18                      Sanofi-Aventis
39      18                              Pfizer
47      18                            Symantec
37      18                            Novartis
50      18  Taiwan Semiconductor Manufacturing
34      18                          Mitsubishi
51      18                   Texas instruments
33      18                           Microsoft
52      18                            Unilever
45      18                                Sony
59      18                               Yahoo
58      18                               Xerox
5       18                     Bank of America
7       18                               Canon
11      18                               Cisco
15      18                                Ford
16      18                   General Electrics
19      18                     GlaxoSmithKline
14      18                                Dell
21      18                               Honda
24      18                               Intel
22      19                                  HP
55      20                         Wells Fargo
26      20                      JPMorgan Chase
13      21                   DuPont de Nemours
53      22                       Valero Energy
3       23                    American express
48      24                              Toyota
6       25            British American Tobacco
9       26                   Colgate-Palmolive
27      27                      Kimberly-Clark
41      28                       Philip Morris
1       29                                 AIG
35      30                            Navistar
23      31                                 IBM
18      32                       Goldman Sachs
2       33                              Amazon
30      34                          MasterCard
0       35                               Apple
17      36                     Google/Alphabet</code></pre>
</div>
</div>
<p>Como era de esperar, las etiquetas del clúster agrupan a Intel, Texas instruments en el mismo clúster. Pero tenga en cuenta que las etiquetas de clúster de scipy comienzan en 1, no en 0 como lo hacen en <code>scikit-learn.</code></p>
</section>
<section id="t-sne-para-mapas-bidimensionales" class="level3">
<h3 class="anchored" data-anchor-id="t-sne-para-mapas-bidimensionales">t-SNE para mapas bidimensionales</h3>
<p>En esta sección, aprenderá un método de aprendizaje no supervisado para visualización llamado <code>t-SNE</code>.</p>
<blockquote class="blockquote">
<p>t-SNE significa “incrustación de vecinos estocásticos distribuidos en t”</p>
</blockquote>
<p>Tiene un nombre complicado, pero tiene un propósito muy simple. Mapea muestras de su espacio de alta dimensión a un espacio de 2D o 3D dimensiones para que puedan visualizarse. Si bien es inevitable cierta distorsión, t-SNE hace un gran trabajo de representar aproximadamente las distancias entre las muestras. Por este motivo, t-SNE es una ayuda visual invaluable para comprender un conjunto de datos.</p>
<section id="t-sne-en-el-dataset-iris" class="level4">
<h4 class="anchored" data-anchor-id="t-sne-en-el-dataset-iris">t-SNE en el dataset iris</h4>
<p>Para ver qué tipo de conocimientos son posibles con t-SNE, veamos cómo funciona en el conjunto de datos del iris. Las muestras de iris están en un espacio de cuatro dimensiones, donde cada dimensión corresponde a una de las cuatro medidas del iris, como la longitud y el ancho de los pétalos.</p>
<p>Ahora a t-SNE solo se le dieron las medidas de las muestras de iris. En particular, no se proporcionó ninguna información sobre las tres especies de iris. Pero si coloreamos las especies de manera diferente en el diagrama de dispersión vemos que t-SNE ha mantedio las especies separadas.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/fig18.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="500"></p>
</figure>
</div>
<p>Sin embargo, este diagrama de dispersión nos da una nueva perspectiva. Aprendemos que hay dos especies de iris, versicolor y virginica, cuyas muestras están muy juntas en el espacio. Por lo tanto, podría suceder que el conjunto de datos del iris parezca tener dos grupos en lugar de tres. Esto es compatible con nuestros ejemplos anteriores usando KMeans, donde vimos que la agrupación con 2 grupos también tenía una inercia relativamente baja, lo que significa grupos apretados.</p>
</section>
<section id="t-sne-en-sklearn" class="level4">
<h4 class="anchored" data-anchor-id="t-sne-en-sklearn">t-SNE en Sklearn</h4>
<p>t-SNE está disponible en scikit-learn, pero funciona un poco de manera diferente a los componentes de ajuste/transformación que ya conoce.</p>
<p>Para comenzar, importamos <code>TSNE</code> y creamos un objeto TNSE. Aplicamos el método <code>fit_transform</code> a las muestras y luego hacemos un diagrama de dispersión del resultado, colerando los puntos según la especie.</p>
<div id="7c05868d" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.manifold <span class="im">import</span> TSNE</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> TSNE(learning_rate <span class="op">=</span> <span class="dv">100</span>)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>transformed <span class="op">=</span> model.fit_transform(iris)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>xs <span class="op">=</span> transformed[:, <span class="dv">0</span>]</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>ys <span class="op">=</span> transformed[:, <span class="dv">1</span>]</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>plt.scatter(xs, ys, c <span class="op">=</span> species_)</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-22-output-1.png" width="578" height="411" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Hay dos puntos que merecen especial atención:</p>
<ul>
<li><p>El método <code>fit_transform</code> y la</p></li>
<li><p>tasa de aprendizaje (<code>learning_rate</code>)</p></li>
</ul>
<p>t-SNE solo tiene un método <code>fit_transform()</code>. Como era de esperar, el método fit_transform ajusta el modelo y transforma los datos simultáneamente. Sin embargi, t-SNE no tiene métodos de ajuste o <code>fit()</code> y transformación o <code>transform()</code> separados. Esto significa que no se puede ampliar un mapa t-SNE para incluir nuevas muestras. En cambio, debes empezar de nuevo cada vez.</p>
<p>La segunda cosa a tener en cuenta es la <code>tasa de aprendizaje.</code> Está hace que el uso de t-SNE sea más complicado que otras técnicas. Es posible que deba probar diferentes tasas de aprendizaje para diferentes conjuntos de datos.</p>
<p>Está claro, sin embargo, cuando has hecho una mala elección, porque todas las muestras aparecen agrupadas en el diagrama de dispersión. Normalmente es suficiente probar algunos valores entre 50 y 200.</p>
<p>Una última cosa a tener en cuenta es que los ejes de un gráfico t-SNE no tienen ningún significado interpretable. De hecho son diferentes cada vez que se aplica t-SNE, incluso con los mismos datos. Por ejemplo, aquí hay tres gráficos t-SNE de muestras de vino de Piamonte escaladas, generados con el mismo código.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/fig19.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="800"></p>
</figure>
</div>
<p>Tenga en cuenta que si bien la orientación de la trama es diferente cada vez, los tres vinos, las variedades, representadas aquí mediante colores, tienen la misma posición entre si.</p>
</section>
</section>
<section id="mapa-t-sne-del-mercado-bursátil" class="level3">
<h3 class="anchored" data-anchor-id="mapa-t-sne-del-mercado-bursátil">Mapa t-SNE del mercado bursátil</h3>
<p>t-SNE proporciona excelentes visualizaciones cuando se pueden etiquetar las muestras individuales. En el siguiente bloque de código, se aplica t-SNE a los datos del precio de las acciones de la empresa. Un gráfico de dispersión de las características t-SNE resultantes, etiquetadas con los nombres de las empresas, te ofrece un mapa del mercado de valores. Los movimientos de las cotizaciones bursátiles de cada empresa están disponibles en <code>normalized_movements</code> las cuales normalizamos anteriormente.</p>
<div id="41dde582" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import TSNE</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.manifold <span class="im">import</span> TSNE</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> TSNE(learning_rate <span class="op">=</span> <span class="dv">50</span>)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>tsne_features <span class="op">=</span> model.fit_transform(normalized_movements)</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>xs <span class="op">=</span> tsne_features[:, <span class="dv">0</span>]</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>ys <span class="op">=</span> tsne_features[:,<span class="dv">1</span>]</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter plot</span></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>plt.scatter(xs, ys, alpha <span class="op">=</span> <span class="fl">0.5</span>)</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> x, y, company <span class="kw">in</span> <span class="bu">zip</span>(xs, ys, companies):</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>    plt.annotate(company, (x, y), fontsize<span class="op">=</span><span class="dv">5</span>, alpha<span class="op">=</span><span class="fl">0.75</span>)</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-23-output-1.png" width="569" height="411" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="descorrelación-de-datos-y-reducción-de-dimensiones" class="level1">
<h1>Descorrelación de Datos y Reducción de Dimensiones</h1>
<p>La reducción de dimensiones resume un conjunto de datos utilizando sus patrones comunes. En esta sección, aprenderás la técnica más fundamental de reducción de dimensiones, el <strong>análisis de componentes principales</strong> (PCA, por sus siglas en inglés). El PCA se utiliza a menudo antes del aprendizaje supervisado para mejorar el rendimiento y la generalización del modelo. También puede ser útil para aprendizaje no supervisado. Por ejemplo, utilizaremos una variante PCA que te permitirá agrupar articulos de wikipedia según su contenido.</p>
<section id="visualización-de-la-transformación-pca" class="level2">
<h2 class="anchored" data-anchor-id="visualización-de-la-transformación-pca">Visualización de la transformación PCA</h2>
<p>La reducción de dimensiones encuentra patrones en los datos y utiliza estos patrones para reexpresarlos en una forma comprimida. Esto hace que el cálculo posterior con los datos sea mucho más sencillo, eficiente y, esto puede ser de gran importancia en un mundo de grandes conjuntos de datos.</p>
<p>Sin embargo, la función más importante de la reducción de dimensión es reducir un conjunto de datos a su <strong><em>“esqueleto básico”</em></strong>, descartando características ruidosas que causan grandes problemas para las tareas de aprendizaje supervisado como regresión y clasificación.</p>
<blockquote class="blockquote">
<p>En muchas aplicaciones del mundo real, es la reducción de dimensiones la que hace posible la predicción.</p>
</blockquote>
<section id="análisis-de-componentes-principales" class="level3">
<h3 class="anchored" data-anchor-id="análisis-de-componentes-principales">Análisis de componentes principales</h3>
<p>Esta es la técnica de reducción de dimensión más fundamental. Se llama <em>“Análisis de componentes principales”</em>, o <em>“PCA”</em> para abreviar. PCA realiza la reducción de dimensión en dos pasos, y el primero:</p>
<ol type="1">
<li>Llamada <strong>“descorrelación”</strong>, no cambia la dimensión de los datos en absoluto.</li>
</ol>
<p>Es justamente en este primer paso en el cual nos centraremos.</p>
<p>En este <strong>primer paso</strong>, PCA gira las muestras para que queden alineadas con los ejes de coordenadas. De hecho, hace más que eso: PCA también desplaza las muestras para que tengan media cero.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/fig20.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="600"></p>
</figure>
</div>
<p>Estos gráficos de dispersión muestran el efecto del PCA aplicado a dos características del conjunto de datos del vino. Tenga en cuenta que no se pierde información: esto es así sin importar cuántas características tenga su conjunto de datos. Veremos la visualización de esta transformación en ejercicios más adelante.</p>
</section>
<section id="pca-en-scikit---learn" class="level3">
<h3 class="anchored" data-anchor-id="pca-en-scikit---learn">PCA en Scikit - Learn</h3>
<p>Scikit-learn tiene una implementación de PCA y tiene dos métodos de ajuste y transformación como StandardScaler.</p>
<ul>
<li><p><code>fit()</code> el método de ajuste aprende cómo desplazar y rotar las muestras, pero en realidad no las cambia.</p></li>
<li><p><code>transform()</code> el método de transformación, por otro lado, aplica la transformación que se aprendio. En particular, el método de transformación se puede aplicar a muestras nuevas e invisibles.</p></li>
</ul>
<p>Veamos PCA en acción en algunas características del conjunto de datos de vino, estas características son: <code>total_phenols</code> y <code>od280</code>.</p>
<div id="c3a88851" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> pd.read_csv(<span class="st">"wine.csv"</span>)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>varieties <span class="op">=</span> samples[<span class="st">'class_name'</span>]</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> samples.drop(<span class="st">"class_name"</span>, axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>samples <span class="op">=</span> samples[[<span class="st">"total_phenols"</span>, <span class="st">"od280"</span>]]</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>samples</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">total_phenols</th>
<th data-quarto-table-cell-role="th">od280</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2.80</td>
<td>3.92</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2.65</td>
<td>3.40</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2.80</td>
<td>3.17</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>3.85</td>
<td>3.45</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>2.80</td>
<td>2.93</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">173</td>
<td>1.68</td>
<td>1.74</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">174</td>
<td>1.80</td>
<td>1.56</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">175</td>
<td>1.59</td>
<td>1.56</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">176</td>
<td>1.65</td>
<td>1.62</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">177</td>
<td>2.05</td>
<td>1.60</td>
</tr>
</tbody>
</table>

<p>178 rows × 2 columns</p>
</div>
</div>
</div>
<p>Veamos:</p>
<ol type="1">
<li><p>En primer lugar importamos el objeto PCA</p></li>
<li><p>Luego creamos el objeto PCA y los ajustamos a las muestras o samples.</p></li>
</ol>
<div id="df64aa9a" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.decomposition <span class="im">import</span> PCA</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> PCA()</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>model.fit(samples)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<style>#sk-container-id-2 {
  /* Definition of color scheme common for light and dark mode */
  --sklearn-color-text: #000;
  --sklearn-color-text-muted: #666;
  --sklearn-color-line: gray;
  /* Definition of color scheme for unfitted estimators */
  --sklearn-color-unfitted-level-0: #fff5e6;
  --sklearn-color-unfitted-level-1: #f6e4d2;
  --sklearn-color-unfitted-level-2: #ffe0b3;
  --sklearn-color-unfitted-level-3: chocolate;
  /* Definition of color scheme for fitted estimators */
  --sklearn-color-fitted-level-0: #f0f8ff;
  --sklearn-color-fitted-level-1: #d4ebff;
  --sklearn-color-fitted-level-2: #b3dbfd;
  --sklearn-color-fitted-level-3: cornflowerblue;

  /* Specific color for light theme */
  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));
  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-icon: #696969;

  @media (prefers-color-scheme: dark) {
    /* Redefinition of color scheme for dark theme */
    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));
    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-icon: #878787;
  }
}

#sk-container-id-2 {
  color: var(--sklearn-color-text);
}

#sk-container-id-2 pre {
  padding: 0;
}

#sk-container-id-2 input.sk-hidden--visually {
  border: 0;
  clip: rect(1px 1px 1px 1px);
  clip: rect(1px, 1px, 1px, 1px);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  width: 1px;
}

#sk-container-id-2 div.sk-dashed-wrapped {
  border: 1px dashed var(--sklearn-color-line);
  margin: 0 0.4em 0.5em 0.4em;
  box-sizing: border-box;
  padding-bottom: 0.4em;
  background-color: var(--sklearn-color-background);
}

#sk-container-id-2 div.sk-container {
  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`
     but bootstrap.min.css set `[hidden] { display: none !important; }`
     so we also need the `!important` here to be able to override the
     default hidden behavior on the sphinx rendered scikit-learn.org.
     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */
  display: inline-block !important;
  position: relative;
}

#sk-container-id-2 div.sk-text-repr-fallback {
  display: none;
}

div.sk-parallel-item,
div.sk-serial,
div.sk-item {
  /* draw centered vertical line to link estimators */
  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));
  background-size: 2px 100%;
  background-repeat: no-repeat;
  background-position: center center;
}

/* Parallel-specific style estimator block */

#sk-container-id-2 div.sk-parallel-item::after {
  content: "";
  width: 100%;
  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);
  flex-grow: 1;
}

#sk-container-id-2 div.sk-parallel {
  display: flex;
  align-items: stretch;
  justify-content: center;
  background-color: var(--sklearn-color-background);
  position: relative;
}

#sk-container-id-2 div.sk-parallel-item {
  display: flex;
  flex-direction: column;
}

#sk-container-id-2 div.sk-parallel-item:first-child::after {
  align-self: flex-end;
  width: 50%;
}

#sk-container-id-2 div.sk-parallel-item:last-child::after {
  align-self: flex-start;
  width: 50%;
}

#sk-container-id-2 div.sk-parallel-item:only-child::after {
  width: 0;
}

/* Serial-specific style estimator block */

#sk-container-id-2 div.sk-serial {
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: var(--sklearn-color-background);
  padding-right: 1em;
  padding-left: 1em;
}


/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is
clickable and can be expanded/collapsed.
- Pipeline and ColumnTransformer use this feature and define the default style
- Estimators will overwrite some part of the style using the `sk-estimator` class
*/

/* Pipeline and ColumnTransformer style (default) */

#sk-container-id-2 div.sk-toggleable {
  /* Default theme specific background. It is overwritten whether we have a
  specific estimator or a Pipeline/ColumnTransformer */
  background-color: var(--sklearn-color-background);
}

/* Toggleable label */
#sk-container-id-2 label.sk-toggleable__label {
  cursor: pointer;
  display: flex;
  width: 100%;
  margin-bottom: 0;
  padding: 0.5em;
  box-sizing: border-box;
  text-align: center;
  align-items: start;
  justify-content: space-between;
  gap: 0.5em;
}

#sk-container-id-2 label.sk-toggleable__label .caption {
  font-size: 0.6rem;
  font-weight: lighter;
  color: var(--sklearn-color-text-muted);
}

#sk-container-id-2 label.sk-toggleable__label-arrow:before {
  /* Arrow on the left of the label */
  content: "▸";
  float: left;
  margin-right: 0.25em;
  color: var(--sklearn-color-icon);
}

#sk-container-id-2 label.sk-toggleable__label-arrow:hover:before {
  color: var(--sklearn-color-text);
}

/* Toggleable content - dropdown */

#sk-container-id-2 div.sk-toggleable__content {
  max-height: 0;
  max-width: 0;
  overflow: hidden;
  text-align: left;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-2 div.sk-toggleable__content.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-2 div.sk-toggleable__content pre {
  margin: 0.2em;
  border-radius: 0.25em;
  color: var(--sklearn-color-text);
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-2 div.sk-toggleable__content.fitted pre {
  /* unfitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-2 input.sk-toggleable__control:checked~div.sk-toggleable__content {
  /* Expand drop-down */
  max-height: 200px;
  max-width: 100%;
  overflow: auto;
}

#sk-container-id-2 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {
  content: "▾";
}

/* Pipeline/ColumnTransformer-specific style */

#sk-container-id-2 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-2 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator-specific style */

/* Colorize estimator box */
#sk-container-id-2 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-2 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

#sk-container-id-2 div.sk-label label.sk-toggleable__label,
#sk-container-id-2 div.sk-label label {
  /* The background is the default theme color */
  color: var(--sklearn-color-text-on-default-background);
}

/* On hover, darken the color of the background */
#sk-container-id-2 div.sk-label:hover label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

/* Label box, darken color on hover, fitted */
#sk-container-id-2 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator label */

#sk-container-id-2 div.sk-label label {
  font-family: monospace;
  font-weight: bold;
  display: inline-block;
  line-height: 1.2em;
}

#sk-container-id-2 div.sk-label-container {
  text-align: center;
}

/* Estimator-specific */
#sk-container-id-2 div.sk-estimator {
  font-family: monospace;
  border: 1px dotted var(--sklearn-color-border-box);
  border-radius: 0.25em;
  box-sizing: border-box;
  margin-bottom: 0.5em;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-2 div.sk-estimator.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

/* on hover */
#sk-container-id-2 div.sk-estimator:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-2 div.sk-estimator.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Specification for estimator info (e.g. "i" and "?") */

/* Common style for "i" and "?" */

.sk-estimator-doc-link,
a:link.sk-estimator-doc-link,
a:visited.sk-estimator-doc-link {
  float: right;
  font-size: smaller;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1em;
  height: 1em;
  width: 1em;
  text-decoration: none !important;
  margin-left: 0.5em;
  text-align: center;
  /* unfitted */
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
  color: var(--sklearn-color-unfitted-level-1);
}

.sk-estimator-doc-link.fitted,
a:link.sk-estimator-doc-link.fitted,
a:visited.sk-estimator-doc-link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
div.sk-estimator:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover,
div.sk-label-container:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover,
div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

/* Span, style for the box shown on hovering the info icon */
.sk-estimator-doc-link span {
  display: none;
  z-index: 9999;
  position: relative;
  font-weight: normal;
  right: .2ex;
  padding: .5ex;
  margin: .5ex;
  width: min-content;
  min-width: 20ex;
  max-width: 50ex;
  color: var(--sklearn-color-text);
  box-shadow: 2pt 2pt 4pt #999;
  /* unfitted */
  background: var(--sklearn-color-unfitted-level-0);
  border: .5pt solid var(--sklearn-color-unfitted-level-3);
}

.sk-estimator-doc-link.fitted span {
  /* fitted */
  background: var(--sklearn-color-fitted-level-0);
  border: var(--sklearn-color-fitted-level-3);
}

.sk-estimator-doc-link:hover span {
  display: block;
}

/* "?"-specific style due to the `<a>` HTML tag */

#sk-container-id-2 a.estimator_doc_link {
  float: right;
  font-size: 1rem;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1rem;
  height: 1rem;
  width: 1rem;
  text-decoration: none;
  /* unfitted */
  color: var(--sklearn-color-unfitted-level-1);
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
}

#sk-container-id-2 a.estimator_doc_link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
#sk-container-id-2 a.estimator_doc_link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

#sk-container-id-2 a.estimator_doc_link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
}
</style><div id="sk-container-id-2" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>PCA()</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-2" type="checkbox" checked=""><label for="sk-estimator-id-2" class="sk-toggleable__label fitted sk-toggleable__label-arrow"><div><div>PCA</div></div><div><a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.6/modules/generated/sklearn.decomposition.PCA.html">?<span>Documentation for PCA</span></a><span class="sk-estimator-doc-link fitted">i<span>Fitted</span></span></div></label><div class="sk-toggleable__content fitted"><pre>PCA()</pre></div> </div></div></div></div>
</div>
</div>
<p>Ahora utilizamos el objeto PCA ajustado para transformar las muestras. Estos nos devuelve una matriz de muestras transformadas.</p>
<div id="1490c771" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>transformed <span class="op">=</span> model.transform(samples)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(transformed)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[ 1.32771994e+00 -4.51396070e-01]
 [ 8.32496068e-01 -2.33099664e-01]
 [ 7.52168680e-01  2.94789161e-02]
 [ 1.64026613e+00  6.55724013e-01]
 [ 5.67992278e-01  1.83358911e-01]
 [ 8.07948468e-01  5.95331030e-01]
 [ 8.74453372e-01 -4.63619912e-01]
 [ 9.38570037e-01 -3.86879744e-01]
 [ 5.06600144e-01  2.34652243e-01]
 [ 1.15919131e+00 -7.60321086e-02]
 [ 8.48343677e-01  1.44589167e-01]
 [ 9.88781053e-02 -2.06553762e-01]
 [ 4.16736898e-01  4.91135760e-02]
 [ 6.06861937e-01  5.41812743e-01]
 [ 9.42293719e-01  5.22178083e-01]
 [ 5.61680527e-01  2.53787328e-01]
 [ 3.53119809e-01  3.62885573e-01]
 [ 3.87902672e-01  5.29289156e-01]
 [ 8.04161418e-01  6.37588080e-01]
 [ 8.33858333e-01 -1.69082914e-01]
 [ 1.29479891e+00 -1.63270739e-01]
 [ 7.70704274e-01 -4.94216064e-01]
 [ 1.26729041e+00 -6.48495720e-01]
 [ 9.00000123e-01 -5.11026278e-01]
 [ 1.07786477e+00 -5.94477857e-01]
 [ 6.66192400e-01 -1.20214368e-01]
 [ 8.22597096e-01  3.57906674e-02]
 [ 1.88741351e-01 -2.10150947e-02]
 [ 1.02484606e+00 -2.87916168e-03]
 [ 9.78302386e-01 -3.54921327e-01]
 [ 5.27397239e-01  4.77895909e-01]
 [ 5.68092193e-01  2.61461344e-01]
 [ 2.78304852e-01 -6.97837260e-02]
 [ 7.17885392e-01  2.53587497e-01]
 [ 2.33423186e-01 -1.23501843e-01]
 [ 9.18272518e-01 -2.39611246e-01]
 [ 3.24648697e-01  1.26053574e-01]
 [ 2.12752481e-02  1.84058317e-01]
 [ 1.27349217e-01  3.02782371e-02]
 [ 1.15666661e+00 -4.78607421e-02]
 [ 1.13773136e+00  1.63424506e-01]
 [ 3.97302069e-01 -1.30113340e-01]
 [ 1.33998032e+00  1.24754677e-01]
 [ 5.19123732e-01  1.56929782e-02]
 [ 1.01853431e+00  6.75492544e-02]
 [ 9.07011280e-01 -3.47376638e-02]
 [ 1.24789212e+00  2.01694675e-01]
 [ 1.06730294e+00  1.57112755e-01]
 [ 3.97801644e-01  2.60398824e-01]
 [ 7.49743895e-01  1.35752715e-01]
 [ 5.01350913e-01  1.34790110e-01]
 [ 6.81240688e-01 -3.67345000e-01]
 [ 1.51369481e+00  8.00567726e-01]
 [ 6.96225608e-01  3.36839246e-01]
 [ 6.46957401e-01 -1.43236418e-01]
 [ 7.47319109e-01  2.42026515e-01]
 [ 1.11607157e+00  2.46676255e-01]
 [ 6.27159457e-01  3.94544245e-01]
 [ 9.06648166e-01  6.82269915e-01]
 [-8.09580232e-01  2.65784517e-01]
 [-8.79808818e-01  4.15677631e-01]
 [-9.60435951e-01  4.43948913e-01]
 [-2.41503162e-01 -5.24739364e-02]
 [ 9.70764831e-01  7.59010083e-01]
 [-5.52650543e-01 -6.61599591e-02]
 [-1.59114103e-01  2.95681263e-01]
 [ 8.75252693e-01  1.61199551e-01]
 [ 5.47658212e-01 -6.98789900e-01]
 [-3.72524391e-01  6.17327107e-01]
 [ 6.63201973e-02 -6.35436010e-01]
 [-1.37380688e+00 -4.09528957e-01]
 [ 8.40669660e-01  1.51000834e-01]
 [-1.36991289e-01 -4.26475632e-01]
 [ 1.32599456e+00  2.01594760e-01]
 [ 1.09334927e+00  5.00218553e-01]
 [-8.01243355e-01 -2.23327430e-01]
 [-3.22330126e-01 -1.80407521e-01]
 [-4.39102388e-01 -3.82556572e-01]
 [-4.84846743e-01 -1.09779274e-01]
 [ 7.40707612e-01  7.81476322e-02]
 [ 4.70155270e-01 -2.30075388e-01]
 [ 3.44446641e-01 -4.11727089e-01]
 [-1.06095392e-01 -2.95917432e-01]
 [-8.75358907e-01 -1.09279699e-01]
 [ 2.98402541e-01 -3.73257090e-01]
 [ 3.59794675e-01 -4.24550422e-01]
 [-6.00156824e-01 -1.69809143e-01]
 [ 2.18638097e-01 -6.71481223e-01]
 [-1.15131674e-01 -3.53522515e-01]
 [ 3.98164758e-01 -4.56608755e-01]
 [-7.07892804e-01 -3.14353111e-01]
 [-5.12455165e-01 -6.73106688e-01]
 [-1.01010382e+00 -3.48536483e-01]
 [ 6.27522571e-01 -3.22463334e-01]
 [ 7.32070991e-01  3.32952280e-01]
 [ 1.45421781e-01  1.45488403e-01]
 [-7.15566821e-01 -3.07941444e-01]
 [ 2.61894298e-01  1.13330156e-01]
 [ 9.06847996e-01  8.38474781e-01]
 [ 5.23310443e-01  2.85845660e-01]
 [ 2.25549339e-01 -2.73295042e-01]
 [-4.20366964e-01 -7.50046686e-01]
 [ 7.59443036e-01 -2.89342482e-01]
 [-3.84536736e-04  2.67310066e-01]
 [ 6.74429361e-01 -6.87428748e-01]
 [ 1.33824252e-01 -9.13362624e-01]
 [ 1.48270353e-02 -8.53033010e-01]
 [-7.33839215e-01 -5.79356476e-01]
 [ 3.54945104e-01 -2.12002824e-01]
 [ 7.82764832e-01 -7.42701827e-02]
 [ 7.19547403e-01  5.51911546e-01]
 [ 2.92590365e-01  8.76834900e-02]
 [-4.35215422e-01 -3.46711188e-01]
 [-1.12970087e-01  3.35313697e-01]
 [ 6.13636718e-01 -1.67520819e-01]
 [ 3.03951517e-01 -3.90876590e-02]
 [ 3.49196297e-01 -7.02377121e-01]
 [ 7.80810103e-02 -4.49797428e-01]
 [-8.03768056e-01 -1.95156063e-01]
 [ 1.47147161e-01 -5.07502426e-01]
 [ 9.85113713e-01 -3.48375789e-02]
 [ 1.39486088e+00 -1.23151043e-02]
 [ 3.29098608e-01 -3.98903756e-01]
 [ 5.83040566e-01 -6.37717200e-02]
 [ 1.15131747e+00 -2.25825308e-01]
 [ 7.08349535e-01 -1.94529750e-01]
 [ 4.60456128e-01  1.95019809e-01]
 [-2.37616196e-01 -1.66285532e-02]
 [ 8.10053713e-02 -1.65559063e-01]
 [-1.57088978e-01 -1.23002268e-01]
 [-1.51765144e+00  2.44924053e-01]
 [-1.55253422e+00  4.18037417e-04]
 [-1.69475332e+00 -7.62222149e-02]
 [-1.39582978e+00  3.90730371e-01]
 [-1.03465142e+00  4.79894211e-01]
 [-1.22457663e+00  1.43399910e-01]
 [-1.61635114e+00  1.57985169e-01]
 [-1.03116411e+00  2.03329863e-01]
 [-1.04040022e+00 -1.04800857e-02]
 [-3.38341019e-01  3.15116093e-01]
 [-7.15666736e-01 -3.86043877e-01]
 [-6.82645799e-01 -5.96066775e-01]
 [-9.01105488e-01 -2.18078198e-01]
 [-6.20254514e-01  1.33664222e-01]
 [-1.05614792e+00 -3.10066484e-01]
 [-1.22477646e+00 -1.28049560e-02]
 [-1.82677370e+00 -1.87445500e-01]
 [-9.58410826e-01  2.52653823e-02]
 [-9.95118899e-01  3.55647763e-01]
 [-1.55107204e+00  1.42537220e-01]
 [-1.58050576e+00  1.54098203e-01]
 [-1.39875414e+00  1.06492006e-01]
 [-1.04455039e+00  7.48784543e-01]
 [-1.16288475e+00  3.26413876e-01]
 [-1.33736201e+00  5.51986747e-02]
 [-1.22437680e+00  2.99604775e-01]
 [-1.06312253e+00  2.43062212e-01]
 [-9.29939714e-01  2.62097381e-01]
 [-1.76387346e-01  8.05290560e-01]
 [-4.42752977e-01  7.67220221e-01]
 [-7.88583306e-01  6.65233048e-01]
 [-9.05755229e-01  1.50674266e-01]
 [-7.98618740e-01 -1.73396363e-01]
 [-1.24158667e+00 -1.42100806e-01]
 [-1.32095145e+00 -1.27915207e-01]
 [-1.31211500e+00 -2.26514990e-01]
 [-1.18863133e+00  2.17615377e-01]
 [-1.18388167e+00 -7.30346548e-02]
 [-1.10062992e+00 -5.13748700e-02]
 [-7.32840064e-01  2.01667852e-01]
 [-1.26995787e+00 -3.00830372e-01]
 [-1.33367487e+00 -6.51608079e-02]
 [-1.08634441e+00  1.06092346e-01]
 [-1.06332236e+00  8.68573465e-02]
 [-1.12451466e+00  2.94355544e-01]
 [-1.25915966e+00  1.33201192e-01]
 [-1.17464556e+00  1.40775294e-01]
 [-9.33526935e-01  4.60559297e-01]]</code></pre>
</div>
</div>
<p>Esta nueva matriz tiene el mismo número de filas y columnas que la matriz de muestra original. En particular, hay una fila para cada muestra transformada. Las columnas de la nueva matriz corresponden a <em>“características de PCA”</em>, tales como las características originales que correspondían a columnas de la matriz original.</p>
</section>
<section id="las-características-de-pca-no-están-correlacionadas" class="level3">
<h3 class="anchored" data-anchor-id="las-características-de-pca-no-están-correlacionadas">LAs características de PCA no están correlacionadas</h3>
<p>A menudo ocurre que las características de un conjunto de datos están correlacionadas. Lo mismo ocurre con muchas de las características del conjunto de datos del vino, por ejemplo. Sin embargo, del PCA, debido a la rotación que realiza, <em>“descorrelaciona”</em> los datos, en el sentido de que las columnas de la matriz transformada no están correlacionadas linealmente.</p>
<p>Como sabemos la correlación lineal se puede medir con la <code>correlación de Pearson.</code> Toma valores entre -1 y 1, donde los valores mayores indican una correlación más fuerte y 0 indica que no hay correlación lineal. A continuación se muestran algunos ejemplos de características con distintos grados de correlación.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/fig21.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="600"></p>
</figure>
</div>
</section>
<section id="componentes-principales" class="level3">
<h3 class="anchored" data-anchor-id="componentes-principales">Componentes Principales</h3>
<p>Finalmente, al PCA se le denomina <em>“análisis de componentes principales”</em> porque aprende los <em>“componentes principales”</em> de los datos. Estas son las direcciones en las que las muestran varían más, representadas aquí en rojo.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/fig22.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="300"></p>
</figure>
</div>
<p>Son los componentes principales que PCA alinea con los ejes de coordenadas. Una vez ajustado un modelo PCA, los componentes proncipales están disponibles como atributos de componentes.</p>
<div id="e9e81aab" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(model.components_)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[ 0.64116665  0.76740167]
 [ 0.76740167 -0.64116665]]</code></pre>
</div>
</div>
<p>Esta es una matriz numpy con una fila para cada componente principal.<br>
</p>
</section>
</section>
<section id="dimensión-intrínseca" class="level2">
<h2 class="anchored" data-anchor-id="dimensión-intrínseca">Dimensión Intrínseca</h2>
<p>Consideremos un conjunto de datos con 2 características: <strong>latitud</strong> y <strong>longitud</strong>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/fig23.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="300"></p>
</figure>
</div>
<p>Estas dos características podrían rastrear el vuelo de un avión, por ejemplo. Este conjunto de datos es bidimensional, pero resulta que se puede analizar observando el desplazamiento a lo largo de la trayectoria de vuelo.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/fig24.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="300"></p>
</figure>
</div>
<p>Este conjunto de datos es intrínsicamente unidimensional.</p>
<section id="dimensión-intrínsica" class="level3">
<h3 class="anchored" data-anchor-id="dimensión-intrínsica">Dimensión Intrínsica</h3>
<p>La dimensión intrínsica de un conjunto de datos es el número de características necesarias para aproximarlo. La dimensión intrínsica informa la reducción de la dimensión, porque nos dice cuánto se puede comprimir un conjunto de datos.</p>
<p>Obtendremos una comprensión sólida de la dimensión intrínsica y seremos capaz de utilizar PCA para aidentificarlo en conjuntos de datos del mundo real que tienen miles de características.</p>
<p>Para ilustrar mejor la dimensión intrínseca, consideremos un conjunto de datos de ejemplo que contiene solo algunas de las muestras del conjunto de datos iris. En concreto, tomaremos tres medidas del iris.</p>
<ul>
<li><p>sepal length (largo del sépalo)</p></li>
<li><p>sepal width (ancho del sépalo)</p></li>
<li><p>petal width (ancho del pétalo)</p></li>
</ul>
<div id="ca6b8cda" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>iris_sample <span class="op">=</span> iris[[<span class="st">'sepal length (cm)'</span>, <span class="st">'sepal width (cm)'</span>,<span class="st">'petal width (cm)'</span>]]</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>iris_sample</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">sepal length (cm)</th>
<th data-quarto-table-cell-role="th">sepal width (cm)</th>
<th data-quarto-table-cell-role="th">petal width (cm)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>5.1</td>
<td>3.5</td>
<td>0.2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>4.9</td>
<td>3.0</td>
<td>0.2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>4.7</td>
<td>3.2</td>
<td>0.2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>4.6</td>
<td>3.1</td>
<td>0.2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>5.0</td>
<td>3.6</td>
<td>0.2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">145</td>
<td>6.7</td>
<td>3.0</td>
<td>2.3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">146</td>
<td>6.3</td>
<td>2.5</td>
<td>1.9</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">147</td>
<td>6.5</td>
<td>3.0</td>
<td>2.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">148</td>
<td>6.2</td>
<td>3.4</td>
<td>2.3</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">149</td>
<td>5.9</td>
<td>3.0</td>
<td>1.8</td>
</tr>
</tbody>
</table>

<p>150 rows × 3 columns</p>
</div>
</div>
</div>
<p>Cada muestra se representa como un punto en el espacio tridimensional. Sin embargo, si hacemos un gráfico de dispersión 3D de las muestras, vemos que todas están muy cerca de una lámila plana bidimensional.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/fig25.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="300"></p>
</figure>
</div>
<p>Esto significa que los datos se pueden aproximar utilizando sólo dos coordenadas, sin perder mucha información. Entonces, este conjunto de datos tiene una dimensión intrínseca de 2. PEro los gráficos de dispersión solo son posibles si hay 3 características o menos.</p>
</section>
<section id="pca-identifica-la-dimensión-intrínseca" class="level3">
<h3 class="anchored" data-anchor-id="pca-identifica-la-dimensión-intrínseca">PCA identifica la dimensión intrínseca</h3>
<p><strong>Cómo se puede identificar la dimensión intrínseca, si hay muchas características?</strong></p>
<p>Aquí es donde el PCA resulta muy útil. La dimensión intrínseca se puede identificar contando las características de PCA que tienen alta varianza. Para ver cómo, veamos qué sucece cuando se aplica PCA al conjunto de datos de muestra versicolor.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/fig26.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="400"></p>
</figure>
</div>
<p>PCA gira y desplaza las muestras para alinearlas con los ejes de coordenadas. Esto expresa las muestras utilizando tres características PCA.</p>
</section>
<section id="las-carasterísticas-de-pca-se-ordenan-por-varianza-descendente" class="level3">
<h3 class="anchored" data-anchor-id="las-carasterísticas-de-pca-se-ordenan-por-varianza-descendente">Las carasterísticas de PCA se ordenan por varianza descendente</h3>
<p>Las características de PCA están en un orden especial.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/fig27.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="500"></p>
</figure>
</div>
<p>Aquí se muestra un gráfico de barras que muestra la varianza de cada una de las características de PCA. Como se puede ver, cada característica de PCA tiene menos variación que la primera. Esto concuerda con el diagrama de dispersión de las características de PCA, donde las muestras no varían mucho en la dirección vertical. En las otras dos direcciones, sin embargo, la variación es evidente.</p>
</section>
<section id="varianza-y-dimensión-intrínseca" class="level3">
<h3 class="anchored" data-anchor-id="varianza-y-dimensión-intrínseca">Varianza y Dimensión Intrínseca</h3>
<ul>
<li><p>La dimensión intrínseca es el número de características de PCA que tiene una varianza significativa.</p>
<p><img src="img/fig28.png" class="img-fluid" width="200"></p></li>
</ul>
<p>En nuestro ejemplo, solo las dos primeras características de PCA tienen una varianza significativa. Por lo tanto, este conjunto de datos tiene una dimensión intrínseca de 2, lo que concuerda con lo que observamos al inspeccionar el diagrama de dispersión.</p>
</section>
<section id="plotting-de-varianza-de-pca" class="level3">
<h3 class="anchored" data-anchor-id="plotting-de-varianza-de-pca">Plotting de varianza de PCA</h3>
<p>Veamos como gráficar las varianzas de las características del PCA en la práctica.</p>
<div id="be22fc96" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>pca <span class="op">=</span> PCA()</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>pca.fit(iris_sample)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<style>#sk-container-id-3 {
  /* Definition of color scheme common for light and dark mode */
  --sklearn-color-text: #000;
  --sklearn-color-text-muted: #666;
  --sklearn-color-line: gray;
  /* Definition of color scheme for unfitted estimators */
  --sklearn-color-unfitted-level-0: #fff5e6;
  --sklearn-color-unfitted-level-1: #f6e4d2;
  --sklearn-color-unfitted-level-2: #ffe0b3;
  --sklearn-color-unfitted-level-3: chocolate;
  /* Definition of color scheme for fitted estimators */
  --sklearn-color-fitted-level-0: #f0f8ff;
  --sklearn-color-fitted-level-1: #d4ebff;
  --sklearn-color-fitted-level-2: #b3dbfd;
  --sklearn-color-fitted-level-3: cornflowerblue;

  /* Specific color for light theme */
  --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, white)));
  --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, black)));
  --sklearn-color-icon: #696969;

  @media (prefers-color-scheme: dark) {
    /* Redefinition of color scheme for dark theme */
    --sklearn-color-text-on-default-background: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-background: var(--sg-background-color, var(--theme-background, var(--jp-layout-color0, #111)));
    --sklearn-color-border-box: var(--sg-text-color, var(--theme-code-foreground, var(--jp-content-font-color1, white)));
    --sklearn-color-icon: #878787;
  }
}

#sk-container-id-3 {
  color: var(--sklearn-color-text);
}

#sk-container-id-3 pre {
  padding: 0;
}

#sk-container-id-3 input.sk-hidden--visually {
  border: 0;
  clip: rect(1px 1px 1px 1px);
  clip: rect(1px, 1px, 1px, 1px);
  height: 1px;
  margin: -1px;
  overflow: hidden;
  padding: 0;
  position: absolute;
  width: 1px;
}

#sk-container-id-3 div.sk-dashed-wrapped {
  border: 1px dashed var(--sklearn-color-line);
  margin: 0 0.4em 0.5em 0.4em;
  box-sizing: border-box;
  padding-bottom: 0.4em;
  background-color: var(--sklearn-color-background);
}

#sk-container-id-3 div.sk-container {
  /* jupyter's `normalize.less` sets `[hidden] { display: none; }`
     but bootstrap.min.css set `[hidden] { display: none !important; }`
     so we also need the `!important` here to be able to override the
     default hidden behavior on the sphinx rendered scikit-learn.org.
     See: https://github.com/scikit-learn/scikit-learn/issues/21755 */
  display: inline-block !important;
  position: relative;
}

#sk-container-id-3 div.sk-text-repr-fallback {
  display: none;
}

div.sk-parallel-item,
div.sk-serial,
div.sk-item {
  /* draw centered vertical line to link estimators */
  background-image: linear-gradient(var(--sklearn-color-text-on-default-background), var(--sklearn-color-text-on-default-background));
  background-size: 2px 100%;
  background-repeat: no-repeat;
  background-position: center center;
}

/* Parallel-specific style estimator block */

#sk-container-id-3 div.sk-parallel-item::after {
  content: "";
  width: 100%;
  border-bottom: 2px solid var(--sklearn-color-text-on-default-background);
  flex-grow: 1;
}

#sk-container-id-3 div.sk-parallel {
  display: flex;
  align-items: stretch;
  justify-content: center;
  background-color: var(--sklearn-color-background);
  position: relative;
}

#sk-container-id-3 div.sk-parallel-item {
  display: flex;
  flex-direction: column;
}

#sk-container-id-3 div.sk-parallel-item:first-child::after {
  align-self: flex-end;
  width: 50%;
}

#sk-container-id-3 div.sk-parallel-item:last-child::after {
  align-self: flex-start;
  width: 50%;
}

#sk-container-id-3 div.sk-parallel-item:only-child::after {
  width: 0;
}

/* Serial-specific style estimator block */

#sk-container-id-3 div.sk-serial {
  display: flex;
  flex-direction: column;
  align-items: center;
  background-color: var(--sklearn-color-background);
  padding-right: 1em;
  padding-left: 1em;
}


/* Toggleable style: style used for estimator/Pipeline/ColumnTransformer box that is
clickable and can be expanded/collapsed.
- Pipeline and ColumnTransformer use this feature and define the default style
- Estimators will overwrite some part of the style using the `sk-estimator` class
*/

/* Pipeline and ColumnTransformer style (default) */

#sk-container-id-3 div.sk-toggleable {
  /* Default theme specific background. It is overwritten whether we have a
  specific estimator or a Pipeline/ColumnTransformer */
  background-color: var(--sklearn-color-background);
}

/* Toggleable label */
#sk-container-id-3 label.sk-toggleable__label {
  cursor: pointer;
  display: flex;
  width: 100%;
  margin-bottom: 0;
  padding: 0.5em;
  box-sizing: border-box;
  text-align: center;
  align-items: start;
  justify-content: space-between;
  gap: 0.5em;
}

#sk-container-id-3 label.sk-toggleable__label .caption {
  font-size: 0.6rem;
  font-weight: lighter;
  color: var(--sklearn-color-text-muted);
}

#sk-container-id-3 label.sk-toggleable__label-arrow:before {
  /* Arrow on the left of the label */
  content: "▸";
  float: left;
  margin-right: 0.25em;
  color: var(--sklearn-color-icon);
}

#sk-container-id-3 label.sk-toggleable__label-arrow:hover:before {
  color: var(--sklearn-color-text);
}

/* Toggleable content - dropdown */

#sk-container-id-3 div.sk-toggleable__content {
  max-height: 0;
  max-width: 0;
  overflow: hidden;
  text-align: left;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-3 div.sk-toggleable__content.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-3 div.sk-toggleable__content pre {
  margin: 0.2em;
  border-radius: 0.25em;
  color: var(--sklearn-color-text);
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-3 div.sk-toggleable__content.fitted pre {
  /* unfitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

#sk-container-id-3 input.sk-toggleable__control:checked~div.sk-toggleable__content {
  /* Expand drop-down */
  max-height: 200px;
  max-width: 100%;
  overflow: auto;
}

#sk-container-id-3 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {
  content: "▾";
}

/* Pipeline/ColumnTransformer-specific style */

#sk-container-id-3 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-3 div.sk-label.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator-specific style */

/* Colorize estimator box */
#sk-container-id-3 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-3 div.sk-estimator.fitted input.sk-toggleable__control:checked~label.sk-toggleable__label {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

#sk-container-id-3 div.sk-label label.sk-toggleable__label,
#sk-container-id-3 div.sk-label label {
  /* The background is the default theme color */
  color: var(--sklearn-color-text-on-default-background);
}

/* On hover, darken the color of the background */
#sk-container-id-3 div.sk-label:hover label.sk-toggleable__label {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-unfitted-level-2);
}

/* Label box, darken color on hover, fitted */
#sk-container-id-3 div.sk-label.fitted:hover label.sk-toggleable__label.fitted {
  color: var(--sklearn-color-text);
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Estimator label */

#sk-container-id-3 div.sk-label label {
  font-family: monospace;
  font-weight: bold;
  display: inline-block;
  line-height: 1.2em;
}

#sk-container-id-3 div.sk-label-container {
  text-align: center;
}

/* Estimator-specific */
#sk-container-id-3 div.sk-estimator {
  font-family: monospace;
  border: 1px dotted var(--sklearn-color-border-box);
  border-radius: 0.25em;
  box-sizing: border-box;
  margin-bottom: 0.5em;
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-0);
}

#sk-container-id-3 div.sk-estimator.fitted {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-0);
}

/* on hover */
#sk-container-id-3 div.sk-estimator:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-2);
}

#sk-container-id-3 div.sk-estimator.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-2);
}

/* Specification for estimator info (e.g. "i" and "?") */

/* Common style for "i" and "?" */

.sk-estimator-doc-link,
a:link.sk-estimator-doc-link,
a:visited.sk-estimator-doc-link {
  float: right;
  font-size: smaller;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1em;
  height: 1em;
  width: 1em;
  text-decoration: none !important;
  margin-left: 0.5em;
  text-align: center;
  /* unfitted */
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
  color: var(--sklearn-color-unfitted-level-1);
}

.sk-estimator-doc-link.fitted,
a:link.sk-estimator-doc-link.fitted,
a:visited.sk-estimator-doc-link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
div.sk-estimator:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover,
div.sk-label-container:hover .sk-estimator-doc-link:hover,
.sk-estimator-doc-link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

div.sk-estimator.fitted:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover,
div.sk-label-container:hover .sk-estimator-doc-link.fitted:hover,
.sk-estimator-doc-link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

/* Span, style for the box shown on hovering the info icon */
.sk-estimator-doc-link span {
  display: none;
  z-index: 9999;
  position: relative;
  font-weight: normal;
  right: .2ex;
  padding: .5ex;
  margin: .5ex;
  width: min-content;
  min-width: 20ex;
  max-width: 50ex;
  color: var(--sklearn-color-text);
  box-shadow: 2pt 2pt 4pt #999;
  /* unfitted */
  background: var(--sklearn-color-unfitted-level-0);
  border: .5pt solid var(--sklearn-color-unfitted-level-3);
}

.sk-estimator-doc-link.fitted span {
  /* fitted */
  background: var(--sklearn-color-fitted-level-0);
  border: var(--sklearn-color-fitted-level-3);
}

.sk-estimator-doc-link:hover span {
  display: block;
}

/* "?"-specific style due to the `<a>` HTML tag */

#sk-container-id-3 a.estimator_doc_link {
  float: right;
  font-size: 1rem;
  line-height: 1em;
  font-family: monospace;
  background-color: var(--sklearn-color-background);
  border-radius: 1rem;
  height: 1rem;
  width: 1rem;
  text-decoration: none;
  /* unfitted */
  color: var(--sklearn-color-unfitted-level-1);
  border: var(--sklearn-color-unfitted-level-1) 1pt solid;
}

#sk-container-id-3 a.estimator_doc_link.fitted {
  /* fitted */
  border: var(--sklearn-color-fitted-level-1) 1pt solid;
  color: var(--sklearn-color-fitted-level-1);
}

/* On hover */
#sk-container-id-3 a.estimator_doc_link:hover {
  /* unfitted */
  background-color: var(--sklearn-color-unfitted-level-3);
  color: var(--sklearn-color-background);
  text-decoration: none;
}

#sk-container-id-3 a.estimator_doc_link.fitted:hover {
  /* fitted */
  background-color: var(--sklearn-color-fitted-level-3);
}
</style><div id="sk-container-id-3" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>PCA()</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br>On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden=""><div class="sk-item"><div class="sk-estimator fitted sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-3" type="checkbox" checked=""><label for="sk-estimator-id-3" class="sk-toggleable__label fitted sk-toggleable__label-arrow"><div><div>PCA</div></div><div><a class="sk-estimator-doc-link fitted" rel="noreferrer" target="_blank" href="https://scikit-learn.org/1.6/modules/generated/sklearn.decomposition.PCA.html">?<span>Documentation for PCA</span></a><span class="sk-estimator-doc-link fitted">i<span>Fitted</span></span></div></label><div class="sk-toggleable__content fitted"><pre>PCA()</pre></div> </div></div></div></div>
</div>
</div>
<p>Ahora creeamos un rango que enumere las características de PCA</p>
<div id="1f366798" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>features <span class="op">=</span> <span class="bu">range</span>(pca.n_components_)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Hacemos un diagrama de barras de la varianza; las varianzas están disponibles como el atributo <code>explained_variance</code> del modelo PCA.</p>
<div id="77c9b011" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>plt.bar(features, pca.explained_variance_)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>plt.xticks(features)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'variance'</span>)</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'PCA feature'</span>)</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-31-output-1.png" width="589" height="429" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>La dimensión intrínseca es una idea útil que ayuda a orientar la reducción de dimensión. Sin embargo, no siempre es inequívoco. Aquí se muestra u gráfico de las variaciones de las características de PCA para el conjunto de datos del vino.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/fig29.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="400"></p>
</figure>
</div>
<p>Podriamos argumentar a favor de una dimensión intrínseca de 2, de 3 o incluso más, dependiendo del umbral que elijamos.</p>
<p>En la siguiente sección, aprenderá a utilizar la dimensión intrínseca para la reducción de dimensión.</p>
</section>
</section>
<section id="reducción-de-dimensiones-con-pca" class="level2">
<h2 class="anchored" data-anchor-id="reducción-de-dimensiones-con-pca">Reducción de dimensiones con PCA</h2>
<p>La reducción de dimensión representa los mismos datos utilizando menos funciones y es vital para construir pipeline de aprendizaje automático utilizando datos del mundo real. Finalmente aquí, aprenderá cómo realizar la reducción de dimensión utilizando PCA. Ya hemos visto que las características del PCA están en orden decreciente de varianza.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/fig30.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="200"></p>
</figure>
</div>
<p>PCA realiza un reducción de dimensión descartando las características de PCA con menor varianza, lo que asume que es ruido y conserva las características PCA de mayor varianza, que supone que son informativas.</p>
<blockquote class="blockquote">
<p>Para utilizar PCA para la reducción de dimensión, debe especificar cuántas características de PCA desea conservar.</p>
</blockquote>
<p>Por ejemplo, especificar <code>PCA(n_components=2)</code> al crear un modelo PCA le indica que conserve solo las primeras dos características PCA. Una buena opción es la dimensión intrínseca del conjunto de datos, si la conoce. Consideremos inmediatamente un ejemplo:</p>
<p>El conjunto de datos del iris tiene 4 características que representan las 4 mediciones</p>
<div id="8eb6c55c" class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>iris</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">sepal length (cm)</th>
<th data-quarto-table-cell-role="th">sepal width (cm)</th>
<th data-quarto-table-cell-role="th">petal length (cm)</th>
<th data-quarto-table-cell-role="th">petal width (cm)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>5.1</td>
<td>3.5</td>
<td>1.4</td>
<td>0.2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>4.9</td>
<td>3.0</td>
<td>1.4</td>
<td>0.2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>4.7</td>
<td>3.2</td>
<td>1.3</td>
<td>0.2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>4.6</td>
<td>3.1</td>
<td>1.5</td>
<td>0.2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>5.0</td>
<td>3.6</td>
<td>1.4</td>
<td>0.2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">145</td>
<td>6.7</td>
<td>3.0</td>
<td>5.2</td>
<td>2.3</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">146</td>
<td>6.3</td>
<td>2.5</td>
<td>5.0</td>
<td>1.9</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">147</td>
<td>6.5</td>
<td>3.0</td>
<td>5.2</td>
<td>2.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">148</td>
<td>6.2</td>
<td>3.4</td>
<td>5.4</td>
<td>2.3</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">149</td>
<td>5.9</td>
<td>3.0</td>
<td>5.1</td>
<td>1.8</td>
</tr>
</tbody>
</table>

<p>150 rows × 4 columns</p>
</div>
</div>
</div>
<p>Utilicemos un PCA para reducir la dimensión del conjunto de datos del iris a solo 2.</p>
<div id="51e4f71a" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>pca <span class="op">=</span> PCA(n_components<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>pca.fit(iris)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>transformed <span class="op">=</span> pca.transform(iris)</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(transformed.shape)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(150, 2)</code></pre>
</div>
</div>
<p>Al imprimir la forma de las muestras transformadas, vemos que solo hay dos características, como se esperaba.</p>
<p>Aquí se muestra un diagrama de dispersión de las características de PCA, donde los colores representan las tres especies de iris.</p>
<div id="0218132c" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>xs <span class="op">=</span> transformed[:,<span class="dv">0</span>]</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>ys <span class="op">=</span> transformed[:,<span class="dv">1</span>]</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>plt.scatter(xs, ys,c <span class="op">=</span> species_)</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/cell-34-output-1.png" width="582" height="415" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Notablemente, a pesar de haberse reducido la dimensión de 4 a 2, aún es posible distinguir las especies. Recuerde que PCA ni siquiera sabía que existían especies distintas. PCA simplemente tomó las 2 características de PCA con mayor variación.</p>
<p>Como podemos ver estas dos características son muy informativas.</p>
<blockquote class="blockquote">
<p>El PCA descarta las características de baja varianza y supone que las características de mayor varianza son informativas.</p>
</blockquote>
<p>Como sucede con todos los supuestos, existen casos donde esto no se cumple. Sin embargo, como vimos con el conjunto de datos del iris, en la práctica suele suceder esto. En algunos casos, es necesario utilizar una implementación alternativa de PCA.</p>
<section id="matrices-de-frecuencia-de-palabras" class="level3">
<h3 class="anchored" data-anchor-id="matrices-de-frecuencia-de-palabras">Matrices de frecuencia de palabras</h3>
<p>Las matrices de frecuencia de palabras son un gran ejemplo de una implementación alternativa de PCA.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/fig31.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="400"></p>
</figure>
</div>
<p>En una matriz de frecuencia de palabras, cada fila corresponde a un documento y cada columna corresponde a una palabra de un vocabulario fijo. Las entradas de la matriz miden la frecuencia con la que aparece cada palabra en cada documento. Sólo algunas de las palabras del vocabulario aparecen en cualquier documento, por lo que la mayoría de las entradas de la matriz de frecuencia de palabras son cero.</p>
<p>Se dice que las matrices de palabras como esta son <em>“dispersas”</em> y, a menudo, representado utilizando un tipo especial de matriz llamada <code>"csr_matrix".</code></p>
<ul>
<li><code>csr_matrix</code> ahorra espacio al recordar solo las entradas distintas de cero de la matriz.</li>
</ul>
</section>
<section id="truncatedsvd-csr_matrix" class="level3">
<h3 class="anchored" data-anchor-id="truncatedsvd-csr_matrix">TruncatedSVD &amp; csr_matrix</h3>
<p>El PCA de Scikit-Learn no admite csr_matrix y necesitará utilizar TruncatedSVD en su lugar.</p>
<p>TruncatedSVD realiza la misma transformación que PCA, pero acepta matrices csr_matrix como entrada.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.decomposition <span class="im">import</span> TruncatedSVD</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> TruncatedSVD(n_components <span class="op">=</span> <span class="dv">3</span>)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>model.fit(documents)</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>transformed <span class="op">=</span> model.transform(documents)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/j-isaula\.github\.io\/Web_JI\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://utteranc.es/client.js" repo="Isaula/blogComments" issue-term="pathname" theme="github-light" crossorigin="anonymous" async="">
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>© Copyright 2022 Juan Isaula</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>